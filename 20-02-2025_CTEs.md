```python
%load_ext sql
```


```python
%sql oracle+oracledb://c##pavan:pavan@localhost:1521/XE
```

# Data File
- employees.sql


```sql
%%sql
SELECT * FROM users
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>id</th>
            <th>name</th>
            <th>mail</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>Alice</td>
            <td>alice@example.com</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Bob</td>
            <td>bob@example.com</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Charlie</td>
            <td>charlie@example.com</td>
        </tr>
        <tr>
            <td>4</td>
            <td>David</td>
            <td>david@example.com</td>
        </tr>
        <tr>
            <td>5</td>
            <td>Eve</td>
            <td>eve@example.com</td>
        </tr>
        <tr>
            <td>6</td>
            <td>Frank</td>
            <td>frank@example.com</td>
        </tr>
        <tr>
            <td>7</td>
            <td>Grace</td>
            <td>grace@example.com</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Hannah</td>
            <td>hannah@example.com</td>
        </tr>
        <tr>
            <td>9</td>
            <td>Ian</td>
            <td>ian@example.com</td>
        </tr>
        <tr>
            <td>10</td>
            <td>Jack</td>
            <td>jack@example.com</td>
        </tr>
    </tbody>
</table>



# CTEs in SQL
- CTE stands for Common Table Expression
- To simplify a complex query into a more understandable manner  
  we can use CTEs
- CTEs helps us find intermediate results and store them like a table  
  (dummy table) and perform operations on that dummy table
- Syntax of writing a CTE
```sql
WITH cte AS (
    SELECT query
)
```

## Example
- Writing a CTE for hr department employees and re-using that CTE to show the details


```sql
%%sql
WITH hr_employees AS (
    SELECT * 
    FROM employee 
    WHERE department = 'HR')
SELECT id, name, department, salary FROM hr_employees
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>id</th>
            <th>name</th>
            <th>department</th>
            <th>salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>43</td>
            <td>Sophia Hernandez</td>
            <td>HR</td>
            <td>75000</td>
        </tr>
        <tr>
            <td>49</td>
            <td>Mia Robinson</td>
            <td>HR</td>
            <td>71000</td>
        </tr>
        <tr>
            <td>1</td>
            <td>John Doe</td>
            <td>HR</td>
            <td>55000</td>
        </tr>
        <tr>
            <td>5</td>
            <td>David Johnson</td>
            <td>HR</td>
            <td>75000</td>
        </tr>
        <tr>
            <td>13</td>
            <td>Amelia Garcia</td>
            <td>HR</td>
            <td>50000</td>
        </tr>
        <tr>
            <td>18</td>
            <td>Henry Clark</td>
            <td>HR</td>
            <td>80000</td>
        </tr>
        <tr>
            <td>25</td>
            <td>Chloe Walker</td>
            <td>HR</td>
            <td>64000</td>
        </tr>
        <tr>
            <td>28</td>
            <td>Elijah Allen</td>
            <td>HR</td>
            <td>58000</td>
        </tr>
        <tr>
            <td>31</td>
            <td>Ava Mitchell</td>
            <td>HR</td>
            <td>57000</td>
        </tr>
        <tr>
            <td>37</td>
            <td>Sophie Hill</td>
            <td>HR</td>
            <td>56000</td>
        </tr>
        <tr>
            <td>51</td>
            <td>Lucas Walker</td>
            <td>HR</td>
            <td>35000</td>
        </tr>
        <tr>
            <td>56</td>
            <td>Olivia Wright</td>
            <td>HR</td>
            <td>42000</td>
        </tr>
        <tr>
            <td>59</td>
            <td>Jacob Wilson</td>
            <td>HR</td>
            <td>50000</td>
        </tr>
        <tr>
            <td>64</td>
            <td>Lily Adams</td>
            <td>HR</td>
            <td>41000</td>
        </tr>
        <tr>
            <td>68</td>
            <td>Jacob Thomas</td>
            <td>HR</td>
            <td>48000</td>
        </tr>
        <tr>
            <td>73</td>
            <td>Chloe Lee</td>
            <td>HR</td>
            <td>56000</td>
        </tr>
        <tr>
            <td>76</td>
            <td>Aiden Green</td>
            <td>HR</td>
            <td>47000</td>
        </tr>
        <tr>
            <td>79</td>
            <td>Elijah White</td>
            <td>HR</td>
            <td>49000</td>
        </tr>
        <tr>
            <td>88</td>
            <td>Jacob Lewis</td>
            <td>HR</td>
            <td>54000</td>
        </tr>
        <tr>
            <td>91</td>
            <td>Charlotte Anderson</td>
            <td>HR</td>
            <td>35000</td>
        </tr>
        <tr>
            <td>96</td>
            <td>Sophia Lee</td>
            <td>HR</td>
            <td>42000</td>
        </tr>
        <tr>
            <td>100</td>
            <td>Chloe Brown</td>
            <td>HR</td>
            <td>48000</td>
        </tr>
        <tr>
            <td>104</td>
            <td>Isabella Martinez</td>
            <td>HR</td>
            <td>53000</td>
        </tr>
        <tr>
            <td>108</td>
            <td>Madison Wright</td>
            <td>HR</td>
            <td>48000</td>
        </tr>
        <tr>
            <td>113</td>
            <td>Grace Martinez</td>
            <td>HR</td>
            <td>61000</td>
        </tr>
        <tr>
            <td>115</td>
            <td>Mia Robinson</td>
            <td>HR</td>
            <td>58000</td>
        </tr>
    </tbody>
</table>



## Example 2
- Write a CTE for all male employees who are earning more than 55000  
  across all the departments, name the CTE as male_employees
- Get from each age group in male_employees, how many employees fall into that group


```sql
%%sql
WITH male_employees AS (
    SELECT * 
    FROM employee 
    WHERE gender = 'Male'
    AND salary > 55000)
SELECT age, COUNT(*) AS no_of_employees
FROM male_employees
GROUP BY age
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>age</th>
            <th>no_of_employees</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>41</td>
            <td>2</td>
        </tr>
        <tr>
            <td>None</td>
            <td>3</td>
        </tr>
        <tr>
            <td>40</td>
            <td>6</td>
        </tr>
        <tr>
            <td>29</td>
            <td>2</td>
        </tr>
        <tr>
            <td>37</td>
            <td>2</td>
        </tr>
        <tr>
            <td>26</td>
            <td>1</td>
        </tr>
        <tr>
            <td>35</td>
            <td>3</td>
        </tr>
        <tr>
            <td>30</td>
            <td>1</td>
        </tr>
        <tr>
            <td>38</td>
            <td>3</td>
        </tr>
        <tr>
            <td>33</td>
            <td>1</td>
        </tr>
        <tr>
            <td>27</td>
            <td>2</td>
        </tr>
    </tbody>
</table>



## Problem
- Contest Leaderboard - HackerRank
- Link: [Contest Leaderboard](https://www.hackerrank.com/challenges/contest-leaderboard/problem)

### Code


```sql
%%sql
WITH cte AS
(
    SELECT h.hacker_id, h.name, s.challenge_id, MAX(s.score) mx_score FROM
    hackers h
    JOIN
    submissions s
    ON h.hacker_id = s.hacker_id
    GROUP BY h.hacker_id, h.name, s.challenge_id
    ORDER BY h.hacker_id, s.challenge_id
)
SELECT hacker_id, name, SUM(mx_score) AS total_score
FROM cte
GROUP BY hacker_id, name
HAVING SUM(mx_score) > 0
ORDER BY total_score DESC, hacker_id;
```

# Window Functions
- Used to perform analytics on data
- Unlike aggregate functions window functions return 1 result per row
- RANK()
- DENSE_RANK()
- ROW_NUMBER()
- LAG()
- LEAD()
- FIRST_VALUE()
- LAST_VALUE()
- SUM(), MIN(), MAX(), AVG(), COUNT() can also be used as Window functions

## RANK()
- RANK() function is used give ranks to your data (row-wise) based on either  
  one column or sometimes multiple columns
- RANK() can be used to give ranks to a group of data also using the keyword
  *PARITION BY*
- RANK() skips values when there is a tie
- Alice 500 - 1
- Bob 450 - 2
- Charlie 450 - 2
- Diana 400 - 4
- DENSE_RANK() doesn't skip the values while ranking when there is a tie
- Alice 500 - 1
- Bob 450 - 2
- Charlie 450 - 2
- Diana 400 - 3
- Syntax
```sql
RANK() OVER(PARTITION BY col_name ORDER BY col_name)
```

### Giving ranks to all the employees using RANK() based on salary


```sql
%%sql
SELECT id, name, age, department, salary,
RANK() OVER(ORDER BY salary DESC) AS rank
FROM employee WHERE salary IS NOT NULL
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>id</th>
            <th>name</th>
            <th>age</th>
            <th>department</th>
            <th>salary</th>
            <th>rank</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>44</td>
            <td>Evan Moore</td>
            <td>40</td>
            <td>Operations</td>
            <td>85000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>30</td>
            <td>Alexander Green</td>
            <td>41</td>
            <td>SW</td>
            <td>83000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>7</td>
            <td>Michael Davis</td>
            <td>None</td>
            <td>Operations</td>
            <td>82000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>42</td>
            <td>Lucas Rodriguez</td>
            <td>30</td>
            <td>None</td>
            <td>80000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>18</td>
            <td>Henry Clark</td>
            <td>40</td>
            <td>HR</td>
            <td>80000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>27</td>
            <td>Charlotte King</td>
            <td>32</td>
            <td>Operations</td>
            <td>78000</td>
            <td>6</td>
        </tr>
        <tr>
            <td>5</td>
            <td>David Johnson</td>
            <td>32</td>
            <td>HR</td>
            <td>75000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>35</td>
            <td>Jack Carter</td>
            <td>None</td>
            <td>SW</td>
            <td>75000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>61</td>
            <td>William Harris</td>
            <td>38</td>
            <td>None</td>
            <td>75000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>23</td>
            <td>Lily Carter</td>
            <td>33</td>
            <td>Operations</td>
            <td>75000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>43</td>
            <td>Sophia Hernandez</td>
            <td>33</td>
            <td>HR</td>
            <td>75000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Sam Williams</td>
            <td>None</td>
            <td>Operations</td>
            <td>73000</td>
            <td>12</td>
        </tr>
        <tr>
            <td>36</td>
            <td>Liam Allen</td>
            <td>37</td>
            <td>Operations</td>
            <td>73000</td>
            <td>12</td>
        </tr>
        <tr>
            <td>85</td>
            <td>Jack Harris</td>
            <td>40</td>
            <td>SW</td>
            <td>72000</td>
            <td>14</td>
        </tr>
        <tr>
            <td>26</td>
            <td>Matthew Hall</td>
            <td>None</td>
            <td>SW</td>
            <td>72000</td>
            <td>14</td>
        </tr>
        <tr>
            <td>48</td>
            <td>Benjamin Green</td>
            <td>38</td>
            <td>Testing</td>
            <td>72000</td>
            <td>14</td>
        </tr>
        <tr>
            <td>20</td>
            <td>Jacob Scott</td>
            <td>37</td>
            <td>Testing</td>
            <td>71000</td>
            <td>17</td>
        </tr>
        <tr>
            <td>29</td>
            <td>Zoe Wright</td>
            <td>29</td>
            <td>Testing</td>
            <td>71000</td>
            <td>17</td>
        </tr>
        <tr>
            <td>34</td>
            <td>Ruby Harris</td>
            <td>30</td>
            <td>Testing</td>
            <td>71000</td>
            <td>17</td>
        </tr>
        <tr>
            <td>49</td>
            <td>Mia Robinson</td>
            <td>None</td>
            <td>HR</td>
            <td>71000</td>
            <td>17</td>
        </tr>
        <tr>
            <td>101</td>
            <td>James Johnson</td>
            <td>38</td>
            <td>SW</td>
            <td>70000</td>
            <td>21</td>
        </tr>
        <tr>
            <td>10</td>
            <td>Sophia Taylor</td>
            <td>26</td>
            <td>SW</td>
            <td>70000</td>
            <td>21</td>
        </tr>
        <tr>
            <td>63</td>
            <td>Henry Green</td>
            <td>35</td>
            <td>SW</td>
            <td>70000</td>
            <td>21</td>
        </tr>
        <tr>
            <td>40</td>
            <td>Daniel Young</td>
            <td>35</td>
            <td>Operations</td>
            <td>70000</td>
            <td>21</td>
        </tr>
        <tr>
            <td>24</td>
            <td>Benjamin Lewis</td>
            <td>37</td>
            <td>Testing</td>
            <td>69000</td>
            <td>25</td>
        </tr>
        <tr>
            <td>89</td>
            <td>Emma Turner</td>
            <td>36</td>
            <td>Operations</td>
            <td>69000</td>
            <td>25</td>
        </tr>
        <tr>
            <td>47</td>
            <td>Grace Brown</td>
            <td>34</td>
            <td>SW</td>
            <td>69000</td>
            <td>25</td>
        </tr>
        <tr>
            <td>38</td>
            <td>Charlie Scott</td>
            <td>29</td>
            <td>SW</td>
            <td>68000</td>
            <td>28</td>
        </tr>
        <tr>
            <td>72</td>
            <td>Benjamin Walker</td>
            <td>40</td>
            <td>Operations</td>
            <td>68000</td>
            <td>28</td>
        </tr>
        <tr>
            <td>45</td>
            <td>Mason King</td>
            <td>35</td>
            <td>Testing</td>
            <td>67000</td>
            <td>30</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Emily Brown</td>
            <td>30</td>
            <td>Testing</td>
            <td>67000</td>
            <td>30</td>
        </tr>
        <tr>
            <td>32</td>
            <td>Oliver Martin</td>
            <td>None</td>
            <td>SW</td>
            <td>66000</td>
            <td>32</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Olivia Wilson</td>
            <td>25</td>
            <td>Testing</td>
            <td>66000</td>
            <td>32</td>
        </tr>
        <tr>
            <td>98</td>
            <td>Lily Green</td>
            <td>34</td>
            <td>Operations</td>
            <td>65000</td>
            <td>34</td>
        </tr>
        <tr>
            <td>67</td>
            <td>Zoe Evans</td>
            <td>32</td>
            <td>SW</td>
            <td>65000</td>
            <td>34</td>
        </tr>
        <tr>
            <td>87</td>
            <td>Ava Wilson</td>
            <td>35</td>
            <td>Testing</td>
            <td>65000</td>
            <td>34</td>
        </tr>
        <tr>
            <td>15</td>
            <td>Isabella Martinez</td>
            <td>32</td>
            <td>Testing</td>
            <td>64000</td>
            <td>37</td>
        </tr>
        <tr>
            <td>25</td>
            <td>Chloe Walker</td>
            <td>31</td>
            <td>HR</td>
            <td>64000</td>
            <td>37</td>
        </tr>
        <tr>
            <td>12</td>
            <td>Lucas Thomas</td>
            <td>29</td>
            <td>Testing</td>
            <td>63000</td>
            <td>39</td>
        </tr>
        <tr>
            <td>75</td>
            <td>Oliver Wilson</td>
            <td>33</td>
            <td>Operations</td>
            <td>63000</td>
            <td>39</td>
        </tr>
        <tr>
            <td>93</td>
            <td>Mason Harris</td>
            <td>40</td>
            <td>Testing</td>
            <td>62000</td>
            <td>41</td>
        </tr>
        <tr>
            <td>71</td>
            <td>Ava Robinson</td>
            <td>27</td>
            <td>SW</td>
            <td>62000</td>
            <td>41</td>
        </tr>
        <tr>
            <td>84</td>
            <td>Zoe Walker</td>
            <td>31</td>
            <td>Testing</td>
            <td>62000</td>
            <td>41</td>
        </tr>
        <tr>
            <td>120</td>
            <td>Nathan Moore</td>
            <td>32</td>
            <td>SW</td>
            <td>62000</td>
            <td>41</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Jane Smith</td>
            <td>34</td>
            <td>SW</td>
            <td>62000</td>
            <td>41</td>
        </tr>
        <tr>
            <td>113</td>
            <td>Grace Martinez</td>
            <td>36</td>
            <td>HR</td>
            <td>61000</td>
            <td>46</td>
        </tr>
        <tr>
            <td>65</td>
            <td>Noah Carter</td>
            <td>41</td>
            <td>Testing</td>
            <td>60000</td>
            <td>47</td>
        </tr>
        <tr>
            <td>55</td>
            <td>Liam Johnson</td>
            <td>38</td>
            <td>None</td>
            <td>60000</td>
            <td>47</td>
        </tr>
        <tr>
            <td>19</td>
            <td>Mia Young</td>
            <td>26</td>
            <td>SW</td>
            <td>60000</td>
            <td>47</td>
        </tr>
        <tr>
            <td>109</td>
            <td>Samuel Rodriguez</td>
            <td>30</td>
            <td>SW</td>
            <td>60000</td>
            <td>47</td>
        </tr>
        <tr>
            <td>46</td>
            <td>Jack Taylor</td>
            <td>None</td>
            <td>None</td>
            <td>60000</td>
            <td>47</td>
        </tr>
        <tr>
            <td>81</td>
            <td>Emily Walker</td>
            <td>35</td>
            <td>Testing</td>
            <td>60000</td>
            <td>47</td>
        </tr>
        <tr>
            <td>119</td>
            <td>Zoey Miller</td>
            <td>35</td>
            <td>None</td>
            <td>59000</td>
            <td>53</td>
        </tr>
        <tr>
            <td>9</td>
            <td>James Martinez</td>
            <td>40</td>
            <td>None</td>
            <td>59000</td>
            <td>53</td>
        </tr>
        <tr>
            <td>115</td>
            <td>Mia Robinson</td>
            <td>31</td>
            <td>HR</td>
            <td>58000</td>
            <td>55</td>
        </tr>
        <tr>
            <td>105</td>
            <td>Oliver Thomas</td>
            <td>27</td>
            <td>SW</td>
            <td>58000</td>
            <td>55</td>
        </tr>
        <tr>
            <td>82</td>
            <td>Joshua Evans</td>
            <td>27</td>
            <td>SW</td>
            <td>58000</td>
            <td>55</td>
        </tr>
        <tr>
            <td>28</td>
            <td>Elijah Allen</td>
            <td>26</td>
            <td>HR</td>
            <td>58000</td>
            <td>55</td>
        </tr>
        <tr>
            <td>31</td>
            <td>Ava Mitchell</td>
            <td>26</td>
            <td>HR</td>
            <td>57000</td>
            <td>59</td>
        </tr>
        <tr>
            <td>17</td>
            <td>Charlotte Harris</td>
            <td>31</td>
            <td>Operations</td>
            <td>56000</td>
            <td>60</td>
        </tr>
        <tr>
            <td>37</td>
            <td>Sophie Hill</td>
            <td>30</td>
            <td>HR</td>
            <td>56000</td>
            <td>60</td>
        </tr>
        <tr>
            <td>73</td>
            <td>Chloe Lee</td>
            <td>31</td>
            <td>HR</td>
            <td>56000</td>
            <td>60</td>
        </tr>
        <tr>
            <td>58</td>
            <td>Sophia Young</td>
            <td>29</td>
            <td>SW</td>
            <td>55000</td>
            <td>63</td>
        </tr>
        <tr>
            <td>112</td>
            <td>Isaac Nelson</td>
            <td>40</td>
            <td>SW</td>
            <td>55000</td>
            <td>63</td>
        </tr>
        <tr>
            <td>103</td>
            <td>Elijah Turner</td>
            <td>35</td>
            <td>Operations</td>
            <td>55000</td>
            <td>63</td>
        </tr>
        <tr>
            <td>1</td>
            <td>John Doe</td>
            <td>29</td>
            <td>HR</td>
            <td>55000</td>
            <td>63</td>
        </tr>
        <tr>
            <td>62</td>
            <td>Amelia Moore</td>
            <td>30</td>
            <td>Operations</td>
            <td>55000</td>
            <td>63</td>
        </tr>
        <tr>
            <td>90</td>
            <td>Ethan Scott</td>
            <td>28</td>
            <td>SW</td>
            <td>55000</td>
            <td>63</td>
        </tr>
        <tr>
            <td>80</td>
            <td>Oliver Harris</td>
            <td>28</td>
            <td>Operations</td>
            <td>55000</td>
            <td>63</td>
        </tr>
        <tr>
            <td>53</td>
            <td>James Turner</td>
            <td>40</td>
            <td>Testing</td>
            <td>55000</td>
            <td>63</td>
        </tr>
        <tr>
            <td>78</td>
            <td>Lucas Robinson</td>
            <td>30</td>
            <td>SW</td>
            <td>55000</td>
            <td>63</td>
        </tr>
        <tr>
            <td>41</td>
            <td>Megan Mitchell</td>
            <td>28</td>
            <td>None</td>
            <td>55000</td>
            <td>63</td>
        </tr>
        <tr>
            <td>21</td>
            <td>Ella Adams</td>
            <td>27</td>
            <td>None</td>
            <td>54000</td>
            <td>73</td>
        </tr>
        <tr>
            <td>6</td>
            <td>Sarah Lee</td>
            <td>27</td>
            <td>SW</td>
            <td>54000</td>
            <td>73</td>
        </tr>
        <tr>
            <td>99</td>
            <td>Henry Scott</td>
            <td>31</td>
            <td>Testing</td>
            <td>54000</td>
            <td>73</td>
        </tr>
        <tr>
            <td>88</td>
            <td>Jacob Lewis</td>
            <td>33</td>
            <td>HR</td>
            <td>54000</td>
            <td>73</td>
        </tr>
        <tr>
            <td>86</td>
            <td>Emily Mitchell</td>
            <td>29</td>
            <td>Operations</td>
            <td>53000</td>
            <td>77</td>
        </tr>
        <tr>
            <td>104</td>
            <td>Isabella Martinez</td>
            <td>32</td>
            <td>HR</td>
            <td>53000</td>
            <td>77</td>
        </tr>
        <tr>
            <td>94</td>
            <td>Olivia Wilson</td>
            <td>30</td>
            <td>Operations</td>
            <td>53000</td>
            <td>77</td>
        </tr>
        <tr>
            <td>106</td>
            <td>Sophia Wilson</td>
            <td>33</td>
            <td>None</td>
            <td>52000</td>
            <td>80</td>
        </tr>
        <tr>
            <td>97</td>
            <td>Lucas Evans</td>
            <td>30</td>
            <td>Testing</td>
            <td>52000</td>
            <td>80</td>
        </tr>
        <tr>
            <td>69</td>
            <td>Mia Jackson</td>
            <td>30</td>
            <td>Operations</td>
            <td>52000</td>
            <td>80</td>
        </tr>
        <tr>
            <td>66</td>
            <td>Amos King</td>
            <td>27</td>
            <td>Operations</td>
            <td>50000</td>
            <td>83</td>
        </tr>
        <tr>
            <td>59</td>
            <td>Jacob Wilson</td>
            <td>34</td>
            <td>HR</td>
            <td>50000</td>
            <td>83</td>
        </tr>
        <tr>
            <td>118</td>
            <td>Jackson Harris</td>
            <td>33</td>
            <td>Testing</td>
            <td>50000</td>
            <td>83</td>
        </tr>
        <tr>
            <td>13</td>
            <td>Amelia Garcia</td>
            <td>31</td>
            <td>HR</td>
            <td>50000</td>
            <td>83</td>
        </tr>
        <tr>
            <td>52</td>
            <td>Megan Clark</td>
            <td>33</td>
            <td>Operations</td>
            <td>50000</td>
            <td>83</td>
        </tr>
        <tr>
            <td>77</td>
            <td>Emma Thomas</td>
            <td>29</td>
            <td>Testing</td>
            <td>50000</td>
            <td>83</td>
        </tr>
        <tr>
            <td>79</td>
            <td>Elijah White</td>
            <td>32</td>
            <td>HR</td>
            <td>49000</td>
            <td>89</td>
        </tr>
        <tr>
            <td>116</td>
            <td>Joshua Lee</td>
            <td>29</td>
            <td>SW</td>
            <td>49000</td>
            <td>89</td>
        </tr>
        <tr>
            <td>74</td>
            <td>Sophie Scott</td>
            <td>32</td>
            <td>Testing</td>
            <td>49000</td>
            <td>89</td>
        </tr>
        <tr>
            <td>108</td>
            <td>Madison Wright</td>
            <td>32</td>
            <td>HR</td>
            <td>48000</td>
            <td>92</td>
        </tr>
        <tr>
            <td>100</td>
            <td>Chloe Brown</td>
            <td>27</td>
            <td>HR</td>
            <td>48000</td>
            <td>92</td>
        </tr>
        <tr>
            <td>110</td>
            <td>Liam Davis</td>
            <td>34</td>
            <td>Testing</td>
            <td>48000</td>
            <td>92</td>
        </tr>
        <tr>
            <td>54</td>
            <td>Ava Martinez</td>
            <td>26</td>
            <td>SW</td>
            <td>48000</td>
            <td>92</td>
        </tr>
        <tr>
            <td>92</td>
            <td>Liam Carter</td>
            <td>35</td>
            <td>SW</td>
            <td>48000</td>
            <td>92</td>
        </tr>
        <tr>
            <td>68</td>
            <td>Jacob Thomas</td>
            <td>28</td>
            <td>HR</td>
            <td>48000</td>
            <td>92</td>
        </tr>
        <tr>
            <td>76</td>
            <td>Aiden Green</td>
            <td>30</td>
            <td>HR</td>
            <td>47000</td>
            <td>98</td>
        </tr>
        <tr>
            <td>95</td>
            <td>Benjamin Walker</td>
            <td>28</td>
            <td>SW</td>
            <td>47000</td>
            <td>98</td>
        </tr>
        <tr>
            <td>102</td>
            <td>Ava Robinson</td>
            <td>30</td>
            <td>Testing</td>
            <td>46000</td>
            <td>100</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Ella Harris</td>
            <td>26</td>
            <td>Operations</td>
            <td>46000</td>
            <td>100</td>
        </tr>
        <tr>
            <td>83</td>
            <td>Isabella Lee</td>
            <td>28</td>
            <td>Operations</td>
            <td>45000</td>
            <td>102</td>
        </tr>
        <tr>
            <td>60</td>
            <td>Chloe Scott</td>
            <td>33</td>
            <td>Testing</td>
            <td>45000</td>
            <td>102</td>
        </tr>
        <tr>
            <td>117</td>
            <td>Chloe Davis</td>
            <td>27</td>
            <td>Operations</td>
            <td>45000</td>
            <td>102</td>
        </tr>
        <tr>
            <td>96</td>
            <td>Sophia Lee</td>
            <td>33</td>
            <td>HR</td>
            <td>42000</td>
            <td>105</td>
        </tr>
        <tr>
            <td>56</td>
            <td>Olivia Wright</td>
            <td>32</td>
            <td>HR</td>
            <td>42000</td>
            <td>105</td>
        </tr>
        <tr>
            <td>64</td>
            <td>Lily Adams</td>
            <td>29</td>
            <td>HR</td>
            <td>41000</td>
            <td>107</td>
        </tr>
        <tr>
            <td>114</td>
            <td>Benjamin Carter</td>
            <td>28</td>
            <td>Testing</td>
            <td>41000</td>
            <td>107</td>
        </tr>
        <tr>
            <td>107</td>
            <td>Aiden Clark</td>
            <td>29</td>
            <td>Operations</td>
            <td>39000</td>
            <td>109</td>
        </tr>
        <tr>
            <td>51</td>
            <td>Lucas Walker</td>
            <td>29</td>
            <td>HR</td>
            <td>35000</td>
            <td>110</td>
        </tr>
        <tr>
            <td>57</td>
            <td>Mason Lee</td>
            <td>26</td>
            <td>Operations</td>
            <td>35000</td>
            <td>110</td>
        </tr>
        <tr>
            <td>70</td>
            <td>Jack Davis</td>
            <td>36</td>
            <td>Testing</td>
            <td>35000</td>
            <td>110</td>
        </tr>
        <tr>
            <td>91</td>
            <td>Charlotte Anderson</td>
            <td>29</td>
            <td>HR</td>
            <td>35000</td>
            <td>110</td>
        </tr>
    </tbody>
</table>




```python
# Breaking the ties using multiple columns in RANK()
%%sql
SELECT id, name, age, department, salary,
RANK() OVER(ORDER BY salary DESC, age ASC) AS rank
FROM employee WHERE salary IS NOT NULL
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>id</th>
            <th>name</th>
            <th>age</th>
            <th>department</th>
            <th>salary</th>
            <th>rank</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>44</td>
            <td>Evan Moore</td>
            <td>40</td>
            <td>Operations</td>
            <td>85000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>30</td>
            <td>Alexander Green</td>
            <td>41</td>
            <td>SW</td>
            <td>83000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>7</td>
            <td>Michael Davis</td>
            <td>None</td>
            <td>Operations</td>
            <td>82000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>42</td>
            <td>Lucas Rodriguez</td>
            <td>30</td>
            <td>None</td>
            <td>80000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>18</td>
            <td>Henry Clark</td>
            <td>40</td>
            <td>HR</td>
            <td>80000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>27</td>
            <td>Charlotte King</td>
            <td>32</td>
            <td>Operations</td>
            <td>78000</td>
            <td>6</td>
        </tr>
        <tr>
            <td>5</td>
            <td>David Johnson</td>
            <td>32</td>
            <td>HR</td>
            <td>75000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>23</td>
            <td>Lily Carter</td>
            <td>33</td>
            <td>Operations</td>
            <td>75000</td>
            <td>8</td>
        </tr>
        <tr>
            <td>43</td>
            <td>Sophia Hernandez</td>
            <td>33</td>
            <td>HR</td>
            <td>75000</td>
            <td>8</td>
        </tr>
        <tr>
            <td>61</td>
            <td>William Harris</td>
            <td>38</td>
            <td>None</td>
            <td>75000</td>
            <td>10</td>
        </tr>
        <tr>
            <td>35</td>
            <td>Jack Carter</td>
            <td>None</td>
            <td>SW</td>
            <td>75000</td>
            <td>11</td>
        </tr>
        <tr>
            <td>36</td>
            <td>Liam Allen</td>
            <td>37</td>
            <td>Operations</td>
            <td>73000</td>
            <td>12</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Sam Williams</td>
            <td>None</td>
            <td>Operations</td>
            <td>73000</td>
            <td>13</td>
        </tr>
        <tr>
            <td>48</td>
            <td>Benjamin Green</td>
            <td>38</td>
            <td>Testing</td>
            <td>72000</td>
            <td>14</td>
        </tr>
        <tr>
            <td>85</td>
            <td>Jack Harris</td>
            <td>40</td>
            <td>SW</td>
            <td>72000</td>
            <td>15</td>
        </tr>
        <tr>
            <td>26</td>
            <td>Matthew Hall</td>
            <td>None</td>
            <td>SW</td>
            <td>72000</td>
            <td>16</td>
        </tr>
        <tr>
            <td>29</td>
            <td>Zoe Wright</td>
            <td>29</td>
            <td>Testing</td>
            <td>71000</td>
            <td>17</td>
        </tr>
        <tr>
            <td>34</td>
            <td>Ruby Harris</td>
            <td>30</td>
            <td>Testing</td>
            <td>71000</td>
            <td>18</td>
        </tr>
        <tr>
            <td>20</td>
            <td>Jacob Scott</td>
            <td>37</td>
            <td>Testing</td>
            <td>71000</td>
            <td>19</td>
        </tr>
        <tr>
            <td>49</td>
            <td>Mia Robinson</td>
            <td>None</td>
            <td>HR</td>
            <td>71000</td>
            <td>20</td>
        </tr>
        <tr>
            <td>10</td>
            <td>Sophia Taylor</td>
            <td>26</td>
            <td>SW</td>
            <td>70000</td>
            <td>21</td>
        </tr>
        <tr>
            <td>63</td>
            <td>Henry Green</td>
            <td>35</td>
            <td>SW</td>
            <td>70000</td>
            <td>22</td>
        </tr>
        <tr>
            <td>40</td>
            <td>Daniel Young</td>
            <td>35</td>
            <td>Operations</td>
            <td>70000</td>
            <td>22</td>
        </tr>
        <tr>
            <td>101</td>
            <td>James Johnson</td>
            <td>38</td>
            <td>SW</td>
            <td>70000</td>
            <td>24</td>
        </tr>
        <tr>
            <td>47</td>
            <td>Grace Brown</td>
            <td>34</td>
            <td>SW</td>
            <td>69000</td>
            <td>25</td>
        </tr>
        <tr>
            <td>89</td>
            <td>Emma Turner</td>
            <td>36</td>
            <td>Operations</td>
            <td>69000</td>
            <td>26</td>
        </tr>
        <tr>
            <td>24</td>
            <td>Benjamin Lewis</td>
            <td>37</td>
            <td>Testing</td>
            <td>69000</td>
            <td>27</td>
        </tr>
        <tr>
            <td>38</td>
            <td>Charlie Scott</td>
            <td>29</td>
            <td>SW</td>
            <td>68000</td>
            <td>28</td>
        </tr>
        <tr>
            <td>72</td>
            <td>Benjamin Walker</td>
            <td>40</td>
            <td>Operations</td>
            <td>68000</td>
            <td>29</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Emily Brown</td>
            <td>30</td>
            <td>Testing</td>
            <td>67000</td>
            <td>30</td>
        </tr>
        <tr>
            <td>45</td>
            <td>Mason King</td>
            <td>35</td>
            <td>Testing</td>
            <td>67000</td>
            <td>31</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Olivia Wilson</td>
            <td>25</td>
            <td>Testing</td>
            <td>66000</td>
            <td>32</td>
        </tr>
        <tr>
            <td>32</td>
            <td>Oliver Martin</td>
            <td>None</td>
            <td>SW</td>
            <td>66000</td>
            <td>33</td>
        </tr>
        <tr>
            <td>67</td>
            <td>Zoe Evans</td>
            <td>32</td>
            <td>SW</td>
            <td>65000</td>
            <td>34</td>
        </tr>
        <tr>
            <td>98</td>
            <td>Lily Green</td>
            <td>34</td>
            <td>Operations</td>
            <td>65000</td>
            <td>35</td>
        </tr>
        <tr>
            <td>87</td>
            <td>Ava Wilson</td>
            <td>35</td>
            <td>Testing</td>
            <td>65000</td>
            <td>36</td>
        </tr>
        <tr>
            <td>25</td>
            <td>Chloe Walker</td>
            <td>31</td>
            <td>HR</td>
            <td>64000</td>
            <td>37</td>
        </tr>
        <tr>
            <td>15</td>
            <td>Isabella Martinez</td>
            <td>32</td>
            <td>Testing</td>
            <td>64000</td>
            <td>38</td>
        </tr>
        <tr>
            <td>12</td>
            <td>Lucas Thomas</td>
            <td>29</td>
            <td>Testing</td>
            <td>63000</td>
            <td>39</td>
        </tr>
        <tr>
            <td>75</td>
            <td>Oliver Wilson</td>
            <td>33</td>
            <td>Operations</td>
            <td>63000</td>
            <td>40</td>
        </tr>
        <tr>
            <td>71</td>
            <td>Ava Robinson</td>
            <td>27</td>
            <td>SW</td>
            <td>62000</td>
            <td>41</td>
        </tr>
        <tr>
            <td>84</td>
            <td>Zoe Walker</td>
            <td>31</td>
            <td>Testing</td>
            <td>62000</td>
            <td>42</td>
        </tr>
        <tr>
            <td>120</td>
            <td>Nathan Moore</td>
            <td>32</td>
            <td>SW</td>
            <td>62000</td>
            <td>43</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Jane Smith</td>
            <td>34</td>
            <td>SW</td>
            <td>62000</td>
            <td>44</td>
        </tr>
        <tr>
            <td>93</td>
            <td>Mason Harris</td>
            <td>40</td>
            <td>Testing</td>
            <td>62000</td>
            <td>45</td>
        </tr>
        <tr>
            <td>113</td>
            <td>Grace Martinez</td>
            <td>36</td>
            <td>HR</td>
            <td>61000</td>
            <td>46</td>
        </tr>
        <tr>
            <td>19</td>
            <td>Mia Young</td>
            <td>26</td>
            <td>SW</td>
            <td>60000</td>
            <td>47</td>
        </tr>
        <tr>
            <td>109</td>
            <td>Samuel Rodriguez</td>
            <td>30</td>
            <td>SW</td>
            <td>60000</td>
            <td>48</td>
        </tr>
        <tr>
            <td>81</td>
            <td>Emily Walker</td>
            <td>35</td>
            <td>Testing</td>
            <td>60000</td>
            <td>49</td>
        </tr>
        <tr>
            <td>55</td>
            <td>Liam Johnson</td>
            <td>38</td>
            <td>None</td>
            <td>60000</td>
            <td>50</td>
        </tr>
        <tr>
            <td>65</td>
            <td>Noah Carter</td>
            <td>41</td>
            <td>Testing</td>
            <td>60000</td>
            <td>51</td>
        </tr>
        <tr>
            <td>46</td>
            <td>Jack Taylor</td>
            <td>None</td>
            <td>None</td>
            <td>60000</td>
            <td>52</td>
        </tr>
        <tr>
            <td>119</td>
            <td>Zoey Miller</td>
            <td>35</td>
            <td>None</td>
            <td>59000</td>
            <td>53</td>
        </tr>
        <tr>
            <td>9</td>
            <td>James Martinez</td>
            <td>40</td>
            <td>None</td>
            <td>59000</td>
            <td>54</td>
        </tr>
        <tr>
            <td>28</td>
            <td>Elijah Allen</td>
            <td>26</td>
            <td>HR</td>
            <td>58000</td>
            <td>55</td>
        </tr>
        <tr>
            <td>105</td>
            <td>Oliver Thomas</td>
            <td>27</td>
            <td>SW</td>
            <td>58000</td>
            <td>56</td>
        </tr>
        <tr>
            <td>82</td>
            <td>Joshua Evans</td>
            <td>27</td>
            <td>SW</td>
            <td>58000</td>
            <td>56</td>
        </tr>
        <tr>
            <td>115</td>
            <td>Mia Robinson</td>
            <td>31</td>
            <td>HR</td>
            <td>58000</td>
            <td>58</td>
        </tr>
        <tr>
            <td>31</td>
            <td>Ava Mitchell</td>
            <td>26</td>
            <td>HR</td>
            <td>57000</td>
            <td>59</td>
        </tr>
        <tr>
            <td>37</td>
            <td>Sophie Hill</td>
            <td>30</td>
            <td>HR</td>
            <td>56000</td>
            <td>60</td>
        </tr>
        <tr>
            <td>17</td>
            <td>Charlotte Harris</td>
            <td>31</td>
            <td>Operations</td>
            <td>56000</td>
            <td>61</td>
        </tr>
        <tr>
            <td>73</td>
            <td>Chloe Lee</td>
            <td>31</td>
            <td>HR</td>
            <td>56000</td>
            <td>61</td>
        </tr>
        <tr>
            <td>41</td>
            <td>Megan Mitchell</td>
            <td>28</td>
            <td>None</td>
            <td>55000</td>
            <td>63</td>
        </tr>
        <tr>
            <td>80</td>
            <td>Oliver Harris</td>
            <td>28</td>
            <td>Operations</td>
            <td>55000</td>
            <td>63</td>
        </tr>
        <tr>
            <td>90</td>
            <td>Ethan Scott</td>
            <td>28</td>
            <td>SW</td>
            <td>55000</td>
            <td>63</td>
        </tr>
        <tr>
            <td>1</td>
            <td>John Doe</td>
            <td>29</td>
            <td>HR</td>
            <td>55000</td>
            <td>66</td>
        </tr>
        <tr>
            <td>58</td>
            <td>Sophia Young</td>
            <td>29</td>
            <td>SW</td>
            <td>55000</td>
            <td>66</td>
        </tr>
        <tr>
            <td>62</td>
            <td>Amelia Moore</td>
            <td>30</td>
            <td>Operations</td>
            <td>55000</td>
            <td>68</td>
        </tr>
        <tr>
            <td>78</td>
            <td>Lucas Robinson</td>
            <td>30</td>
            <td>SW</td>
            <td>55000</td>
            <td>68</td>
        </tr>
        <tr>
            <td>103</td>
            <td>Elijah Turner</td>
            <td>35</td>
            <td>Operations</td>
            <td>55000</td>
            <td>70</td>
        </tr>
        <tr>
            <td>53</td>
            <td>James Turner</td>
            <td>40</td>
            <td>Testing</td>
            <td>55000</td>
            <td>71</td>
        </tr>
        <tr>
            <td>112</td>
            <td>Isaac Nelson</td>
            <td>40</td>
            <td>SW</td>
            <td>55000</td>
            <td>71</td>
        </tr>
        <tr>
            <td>21</td>
            <td>Ella Adams</td>
            <td>27</td>
            <td>None</td>
            <td>54000</td>
            <td>73</td>
        </tr>
        <tr>
            <td>6</td>
            <td>Sarah Lee</td>
            <td>27</td>
            <td>SW</td>
            <td>54000</td>
            <td>73</td>
        </tr>
        <tr>
            <td>99</td>
            <td>Henry Scott</td>
            <td>31</td>
            <td>Testing</td>
            <td>54000</td>
            <td>75</td>
        </tr>
        <tr>
            <td>88</td>
            <td>Jacob Lewis</td>
            <td>33</td>
            <td>HR</td>
            <td>54000</td>
            <td>76</td>
        </tr>
        <tr>
            <td>86</td>
            <td>Emily Mitchell</td>
            <td>29</td>
            <td>Operations</td>
            <td>53000</td>
            <td>77</td>
        </tr>
        <tr>
            <td>94</td>
            <td>Olivia Wilson</td>
            <td>30</td>
            <td>Operations</td>
            <td>53000</td>
            <td>78</td>
        </tr>
        <tr>
            <td>104</td>
            <td>Isabella Martinez</td>
            <td>32</td>
            <td>HR</td>
            <td>53000</td>
            <td>79</td>
        </tr>
        <tr>
            <td>97</td>
            <td>Lucas Evans</td>
            <td>30</td>
            <td>Testing</td>
            <td>52000</td>
            <td>80</td>
        </tr>
        <tr>
            <td>69</td>
            <td>Mia Jackson</td>
            <td>30</td>
            <td>Operations</td>
            <td>52000</td>
            <td>80</td>
        </tr>
        <tr>
            <td>106</td>
            <td>Sophia Wilson</td>
            <td>33</td>
            <td>None</td>
            <td>52000</td>
            <td>82</td>
        </tr>
        <tr>
            <td>66</td>
            <td>Amos King</td>
            <td>27</td>
            <td>Operations</td>
            <td>50000</td>
            <td>83</td>
        </tr>
        <tr>
            <td>77</td>
            <td>Emma Thomas</td>
            <td>29</td>
            <td>Testing</td>
            <td>50000</td>
            <td>84</td>
        </tr>
        <tr>
            <td>13</td>
            <td>Amelia Garcia</td>
            <td>31</td>
            <td>HR</td>
            <td>50000</td>
            <td>85</td>
        </tr>
        <tr>
            <td>118</td>
            <td>Jackson Harris</td>
            <td>33</td>
            <td>Testing</td>
            <td>50000</td>
            <td>86</td>
        </tr>
        <tr>
            <td>52</td>
            <td>Megan Clark</td>
            <td>33</td>
            <td>Operations</td>
            <td>50000</td>
            <td>86</td>
        </tr>
        <tr>
            <td>59</td>
            <td>Jacob Wilson</td>
            <td>34</td>
            <td>HR</td>
            <td>50000</td>
            <td>88</td>
        </tr>
        <tr>
            <td>116</td>
            <td>Joshua Lee</td>
            <td>29</td>
            <td>SW</td>
            <td>49000</td>
            <td>89</td>
        </tr>
        <tr>
            <td>79</td>
            <td>Elijah White</td>
            <td>32</td>
            <td>HR</td>
            <td>49000</td>
            <td>90</td>
        </tr>
        <tr>
            <td>74</td>
            <td>Sophie Scott</td>
            <td>32</td>
            <td>Testing</td>
            <td>49000</td>
            <td>90</td>
        </tr>
        <tr>
            <td>54</td>
            <td>Ava Martinez</td>
            <td>26</td>
            <td>SW</td>
            <td>48000</td>
            <td>92</td>
        </tr>
        <tr>
            <td>100</td>
            <td>Chloe Brown</td>
            <td>27</td>
            <td>HR</td>
            <td>48000</td>
            <td>93</td>
        </tr>
        <tr>
            <td>68</td>
            <td>Jacob Thomas</td>
            <td>28</td>
            <td>HR</td>
            <td>48000</td>
            <td>94</td>
        </tr>
        <tr>
            <td>108</td>
            <td>Madison Wright</td>
            <td>32</td>
            <td>HR</td>
            <td>48000</td>
            <td>95</td>
        </tr>
        <tr>
            <td>110</td>
            <td>Liam Davis</td>
            <td>34</td>
            <td>Testing</td>
            <td>48000</td>
            <td>96</td>
        </tr>
        <tr>
            <td>92</td>
            <td>Liam Carter</td>
            <td>35</td>
            <td>SW</td>
            <td>48000</td>
            <td>97</td>
        </tr>
        <tr>
            <td>95</td>
            <td>Benjamin Walker</td>
            <td>28</td>
            <td>SW</td>
            <td>47000</td>
            <td>98</td>
        </tr>
        <tr>
            <td>76</td>
            <td>Aiden Green</td>
            <td>30</td>
            <td>HR</td>
            <td>47000</td>
            <td>99</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Ella Harris</td>
            <td>26</td>
            <td>Operations</td>
            <td>46000</td>
            <td>100</td>
        </tr>
        <tr>
            <td>102</td>
            <td>Ava Robinson</td>
            <td>30</td>
            <td>Testing</td>
            <td>46000</td>
            <td>101</td>
        </tr>
        <tr>
            <td>117</td>
            <td>Chloe Davis</td>
            <td>27</td>
            <td>Operations</td>
            <td>45000</td>
            <td>102</td>
        </tr>
        <tr>
            <td>83</td>
            <td>Isabella Lee</td>
            <td>28</td>
            <td>Operations</td>
            <td>45000</td>
            <td>103</td>
        </tr>
        <tr>
            <td>60</td>
            <td>Chloe Scott</td>
            <td>33</td>
            <td>Testing</td>
            <td>45000</td>
            <td>104</td>
        </tr>
        <tr>
            <td>56</td>
            <td>Olivia Wright</td>
            <td>32</td>
            <td>HR</td>
            <td>42000</td>
            <td>105</td>
        </tr>
        <tr>
            <td>96</td>
            <td>Sophia Lee</td>
            <td>33</td>
            <td>HR</td>
            <td>42000</td>
            <td>106</td>
        </tr>
        <tr>
            <td>114</td>
            <td>Benjamin Carter</td>
            <td>28</td>
            <td>Testing</td>
            <td>41000</td>
            <td>107</td>
        </tr>
        <tr>
            <td>64</td>
            <td>Lily Adams</td>
            <td>29</td>
            <td>HR</td>
            <td>41000</td>
            <td>108</td>
        </tr>
        <tr>
            <td>107</td>
            <td>Aiden Clark</td>
            <td>29</td>
            <td>Operations</td>
            <td>39000</td>
            <td>109</td>
        </tr>
        <tr>
            <td>57</td>
            <td>Mason Lee</td>
            <td>26</td>
            <td>Operations</td>
            <td>35000</td>
            <td>110</td>
        </tr>
        <tr>
            <td>51</td>
            <td>Lucas Walker</td>
            <td>29</td>
            <td>HR</td>
            <td>35000</td>
            <td>111</td>
        </tr>
        <tr>
            <td>91</td>
            <td>Charlotte Anderson</td>
            <td>29</td>
            <td>HR</td>
            <td>35000</td>
            <td>111</td>
        </tr>
        <tr>
            <td>70</td>
            <td>Jack Davis</td>
            <td>36</td>
            <td>Testing</td>
            <td>35000</td>
            <td>113</td>
        </tr>
    </tbody>
</table>



## Using PARTITION BY in RANK() to give ranks to each department employees separately


```sql
%%sql
SELECT id, name, age, department, salary, 
RANK() OVER(PARTITION BY department ORDER BY salary DESC) AS rank
FROM employee WHERE salary IS NOT NULL
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>id</th>
            <th>name</th>
            <th>age</th>
            <th>department</th>
            <th>salary</th>
            <th>rank</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>18</td>
            <td>Henry Clark</td>
            <td>40</td>
            <td>HR</td>
            <td>80000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>43</td>
            <td>Sophia Hernandez</td>
            <td>33</td>
            <td>HR</td>
            <td>75000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>5</td>
            <td>David Johnson</td>
            <td>32</td>
            <td>HR</td>
            <td>75000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>49</td>
            <td>Mia Robinson</td>
            <td>None</td>
            <td>HR</td>
            <td>71000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>25</td>
            <td>Chloe Walker</td>
            <td>31</td>
            <td>HR</td>
            <td>64000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>113</td>
            <td>Grace Martinez</td>
            <td>36</td>
            <td>HR</td>
            <td>61000</td>
            <td>6</td>
        </tr>
        <tr>
            <td>115</td>
            <td>Mia Robinson</td>
            <td>31</td>
            <td>HR</td>
            <td>58000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>28</td>
            <td>Elijah Allen</td>
            <td>26</td>
            <td>HR</td>
            <td>58000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>31</td>
            <td>Ava Mitchell</td>
            <td>26</td>
            <td>HR</td>
            <td>57000</td>
            <td>9</td>
        </tr>
        <tr>
            <td>73</td>
            <td>Chloe Lee</td>
            <td>31</td>
            <td>HR</td>
            <td>56000</td>
            <td>10</td>
        </tr>
        <tr>
            <td>37</td>
            <td>Sophie Hill</td>
            <td>30</td>
            <td>HR</td>
            <td>56000</td>
            <td>10</td>
        </tr>
        <tr>
            <td>1</td>
            <td>John Doe</td>
            <td>29</td>
            <td>HR</td>
            <td>55000</td>
            <td>12</td>
        </tr>
        <tr>
            <td>88</td>
            <td>Jacob Lewis</td>
            <td>33</td>
            <td>HR</td>
            <td>54000</td>
            <td>13</td>
        </tr>
        <tr>
            <td>104</td>
            <td>Isabella Martinez</td>
            <td>32</td>
            <td>HR</td>
            <td>53000</td>
            <td>14</td>
        </tr>
        <tr>
            <td>13</td>
            <td>Amelia Garcia</td>
            <td>31</td>
            <td>HR</td>
            <td>50000</td>
            <td>15</td>
        </tr>
        <tr>
            <td>59</td>
            <td>Jacob Wilson</td>
            <td>34</td>
            <td>HR</td>
            <td>50000</td>
            <td>15</td>
        </tr>
        <tr>
            <td>79</td>
            <td>Elijah White</td>
            <td>32</td>
            <td>HR</td>
            <td>49000</td>
            <td>17</td>
        </tr>
        <tr>
            <td>108</td>
            <td>Madison Wright</td>
            <td>32</td>
            <td>HR</td>
            <td>48000</td>
            <td>18</td>
        </tr>
        <tr>
            <td>100</td>
            <td>Chloe Brown</td>
            <td>27</td>
            <td>HR</td>
            <td>48000</td>
            <td>18</td>
        </tr>
        <tr>
            <td>68</td>
            <td>Jacob Thomas</td>
            <td>28</td>
            <td>HR</td>
            <td>48000</td>
            <td>18</td>
        </tr>
        <tr>
            <td>76</td>
            <td>Aiden Green</td>
            <td>30</td>
            <td>HR</td>
            <td>47000</td>
            <td>21</td>
        </tr>
        <tr>
            <td>56</td>
            <td>Olivia Wright</td>
            <td>32</td>
            <td>HR</td>
            <td>42000</td>
            <td>22</td>
        </tr>
        <tr>
            <td>96</td>
            <td>Sophia Lee</td>
            <td>33</td>
            <td>HR</td>
            <td>42000</td>
            <td>22</td>
        </tr>
        <tr>
            <td>64</td>
            <td>Lily Adams</td>
            <td>29</td>
            <td>HR</td>
            <td>41000</td>
            <td>24</td>
        </tr>
        <tr>
            <td>51</td>
            <td>Lucas Walker</td>
            <td>29</td>
            <td>HR</td>
            <td>35000</td>
            <td>25</td>
        </tr>
        <tr>
            <td>91</td>
            <td>Charlotte Anderson</td>
            <td>29</td>
            <td>HR</td>
            <td>35000</td>
            <td>25</td>
        </tr>
        <tr>
            <td>44</td>
            <td>Evan Moore</td>
            <td>40</td>
            <td>Operations</td>
            <td>85000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>7</td>
            <td>Michael Davis</td>
            <td>None</td>
            <td>Operations</td>
            <td>82000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>27</td>
            <td>Charlotte King</td>
            <td>32</td>
            <td>Operations</td>
            <td>78000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>23</td>
            <td>Lily Carter</td>
            <td>33</td>
            <td>Operations</td>
            <td>75000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>36</td>
            <td>Liam Allen</td>
            <td>37</td>
            <td>Operations</td>
            <td>73000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Sam Williams</td>
            <td>None</td>
            <td>Operations</td>
            <td>73000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>40</td>
            <td>Daniel Young</td>
            <td>35</td>
            <td>Operations</td>
            <td>70000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>89</td>
            <td>Emma Turner</td>
            <td>36</td>
            <td>Operations</td>
            <td>69000</td>
            <td>8</td>
        </tr>
        <tr>
            <td>72</td>
            <td>Benjamin Walker</td>
            <td>40</td>
            <td>Operations</td>
            <td>68000</td>
            <td>9</td>
        </tr>
        <tr>
            <td>98</td>
            <td>Lily Green</td>
            <td>34</td>
            <td>Operations</td>
            <td>65000</td>
            <td>10</td>
        </tr>
        <tr>
            <td>75</td>
            <td>Oliver Wilson</td>
            <td>33</td>
            <td>Operations</td>
            <td>63000</td>
            <td>11</td>
        </tr>
        <tr>
            <td>17</td>
            <td>Charlotte Harris</td>
            <td>31</td>
            <td>Operations</td>
            <td>56000</td>
            <td>12</td>
        </tr>
        <tr>
            <td>80</td>
            <td>Oliver Harris</td>
            <td>28</td>
            <td>Operations</td>
            <td>55000</td>
            <td>13</td>
        </tr>
        <tr>
            <td>103</td>
            <td>Elijah Turner</td>
            <td>35</td>
            <td>Operations</td>
            <td>55000</td>
            <td>13</td>
        </tr>
        <tr>
            <td>62</td>
            <td>Amelia Moore</td>
            <td>30</td>
            <td>Operations</td>
            <td>55000</td>
            <td>13</td>
        </tr>
        <tr>
            <td>86</td>
            <td>Emily Mitchell</td>
            <td>29</td>
            <td>Operations</td>
            <td>53000</td>
            <td>16</td>
        </tr>
        <tr>
            <td>94</td>
            <td>Olivia Wilson</td>
            <td>30</td>
            <td>Operations</td>
            <td>53000</td>
            <td>16</td>
        </tr>
        <tr>
            <td>69</td>
            <td>Mia Jackson</td>
            <td>30</td>
            <td>Operations</td>
            <td>52000</td>
            <td>18</td>
        </tr>
        <tr>
            <td>66</td>
            <td>Amos King</td>
            <td>27</td>
            <td>Operations</td>
            <td>50000</td>
            <td>19</td>
        </tr>
        <tr>
            <td>52</td>
            <td>Megan Clark</td>
            <td>33</td>
            <td>Operations</td>
            <td>50000</td>
            <td>19</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Ella Harris</td>
            <td>26</td>
            <td>Operations</td>
            <td>46000</td>
            <td>21</td>
        </tr>
        <tr>
            <td>83</td>
            <td>Isabella Lee</td>
            <td>28</td>
            <td>Operations</td>
            <td>45000</td>
            <td>22</td>
        </tr>
        <tr>
            <td>117</td>
            <td>Chloe Davis</td>
            <td>27</td>
            <td>Operations</td>
            <td>45000</td>
            <td>22</td>
        </tr>
        <tr>
            <td>107</td>
            <td>Aiden Clark</td>
            <td>29</td>
            <td>Operations</td>
            <td>39000</td>
            <td>24</td>
        </tr>
        <tr>
            <td>57</td>
            <td>Mason Lee</td>
            <td>26</td>
            <td>Operations</td>
            <td>35000</td>
            <td>25</td>
        </tr>
        <tr>
            <td>30</td>
            <td>Alexander Green</td>
            <td>41</td>
            <td>SW</td>
            <td>83000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>35</td>
            <td>Jack Carter</td>
            <td>None</td>
            <td>SW</td>
            <td>75000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>85</td>
            <td>Jack Harris</td>
            <td>40</td>
            <td>SW</td>
            <td>72000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>26</td>
            <td>Matthew Hall</td>
            <td>None</td>
            <td>SW</td>
            <td>72000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>63</td>
            <td>Henry Green</td>
            <td>35</td>
            <td>SW</td>
            <td>70000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>101</td>
            <td>James Johnson</td>
            <td>38</td>
            <td>SW</td>
            <td>70000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>10</td>
            <td>Sophia Taylor</td>
            <td>26</td>
            <td>SW</td>
            <td>70000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>47</td>
            <td>Grace Brown</td>
            <td>34</td>
            <td>SW</td>
            <td>69000</td>
            <td>8</td>
        </tr>
        <tr>
            <td>38</td>
            <td>Charlie Scott</td>
            <td>29</td>
            <td>SW</td>
            <td>68000</td>
            <td>9</td>
        </tr>
        <tr>
            <td>32</td>
            <td>Oliver Martin</td>
            <td>None</td>
            <td>SW</td>
            <td>66000</td>
            <td>10</td>
        </tr>
        <tr>
            <td>67</td>
            <td>Zoe Evans</td>
            <td>32</td>
            <td>SW</td>
            <td>65000</td>
            <td>11</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Jane Smith</td>
            <td>34</td>
            <td>SW</td>
            <td>62000</td>
            <td>12</td>
        </tr>
        <tr>
            <td>120</td>
            <td>Nathan Moore</td>
            <td>32</td>
            <td>SW</td>
            <td>62000</td>
            <td>12</td>
        </tr>
        <tr>
            <td>71</td>
            <td>Ava Robinson</td>
            <td>27</td>
            <td>SW</td>
            <td>62000</td>
            <td>12</td>
        </tr>
        <tr>
            <td>109</td>
            <td>Samuel Rodriguez</td>
            <td>30</td>
            <td>SW</td>
            <td>60000</td>
            <td>15</td>
        </tr>
        <tr>
            <td>19</td>
            <td>Mia Young</td>
            <td>26</td>
            <td>SW</td>
            <td>60000</td>
            <td>15</td>
        </tr>
        <tr>
            <td>105</td>
            <td>Oliver Thomas</td>
            <td>27</td>
            <td>SW</td>
            <td>58000</td>
            <td>17</td>
        </tr>
        <tr>
            <td>82</td>
            <td>Joshua Evans</td>
            <td>27</td>
            <td>SW</td>
            <td>58000</td>
            <td>17</td>
        </tr>
        <tr>
            <td>58</td>
            <td>Sophia Young</td>
            <td>29</td>
            <td>SW</td>
            <td>55000</td>
            <td>19</td>
        </tr>
        <tr>
            <td>90</td>
            <td>Ethan Scott</td>
            <td>28</td>
            <td>SW</td>
            <td>55000</td>
            <td>19</td>
        </tr>
        <tr>
            <td>78</td>
            <td>Lucas Robinson</td>
            <td>30</td>
            <td>SW</td>
            <td>55000</td>
            <td>19</td>
        </tr>
        <tr>
            <td>112</td>
            <td>Isaac Nelson</td>
            <td>40</td>
            <td>SW</td>
            <td>55000</td>
            <td>19</td>
        </tr>
        <tr>
            <td>6</td>
            <td>Sarah Lee</td>
            <td>27</td>
            <td>SW</td>
            <td>54000</td>
            <td>23</td>
        </tr>
        <tr>
            <td>116</td>
            <td>Joshua Lee</td>
            <td>29</td>
            <td>SW</td>
            <td>49000</td>
            <td>24</td>
        </tr>
        <tr>
            <td>92</td>
            <td>Liam Carter</td>
            <td>35</td>
            <td>SW</td>
            <td>48000</td>
            <td>25</td>
        </tr>
        <tr>
            <td>54</td>
            <td>Ava Martinez</td>
            <td>26</td>
            <td>SW</td>
            <td>48000</td>
            <td>25</td>
        </tr>
        <tr>
            <td>95</td>
            <td>Benjamin Walker</td>
            <td>28</td>
            <td>SW</td>
            <td>47000</td>
            <td>27</td>
        </tr>
        <tr>
            <td>48</td>
            <td>Benjamin Green</td>
            <td>38</td>
            <td>Testing</td>
            <td>72000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>20</td>
            <td>Jacob Scott</td>
            <td>37</td>
            <td>Testing</td>
            <td>71000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>29</td>
            <td>Zoe Wright</td>
            <td>29</td>
            <td>Testing</td>
            <td>71000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>34</td>
            <td>Ruby Harris</td>
            <td>30</td>
            <td>Testing</td>
            <td>71000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>24</td>
            <td>Benjamin Lewis</td>
            <td>37</td>
            <td>Testing</td>
            <td>69000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Emily Brown</td>
            <td>30</td>
            <td>Testing</td>
            <td>67000</td>
            <td>6</td>
        </tr>
        <tr>
            <td>45</td>
            <td>Mason King</td>
            <td>35</td>
            <td>Testing</td>
            <td>67000</td>
            <td>6</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Olivia Wilson</td>
            <td>25</td>
            <td>Testing</td>
            <td>66000</td>
            <td>8</td>
        </tr>
        <tr>
            <td>87</td>
            <td>Ava Wilson</td>
            <td>35</td>
            <td>Testing</td>
            <td>65000</td>
            <td>9</td>
        </tr>
        <tr>
            <td>15</td>
            <td>Isabella Martinez</td>
            <td>32</td>
            <td>Testing</td>
            <td>64000</td>
            <td>10</td>
        </tr>
        <tr>
            <td>12</td>
            <td>Lucas Thomas</td>
            <td>29</td>
            <td>Testing</td>
            <td>63000</td>
            <td>11</td>
        </tr>
        <tr>
            <td>93</td>
            <td>Mason Harris</td>
            <td>40</td>
            <td>Testing</td>
            <td>62000</td>
            <td>12</td>
        </tr>
        <tr>
            <td>84</td>
            <td>Zoe Walker</td>
            <td>31</td>
            <td>Testing</td>
            <td>62000</td>
            <td>12</td>
        </tr>
        <tr>
            <td>81</td>
            <td>Emily Walker</td>
            <td>35</td>
            <td>Testing</td>
            <td>60000</td>
            <td>14</td>
        </tr>
        <tr>
            <td>65</td>
            <td>Noah Carter</td>
            <td>41</td>
            <td>Testing</td>
            <td>60000</td>
            <td>14</td>
        </tr>
        <tr>
            <td>53</td>
            <td>James Turner</td>
            <td>40</td>
            <td>Testing</td>
            <td>55000</td>
            <td>16</td>
        </tr>
        <tr>
            <td>99</td>
            <td>Henry Scott</td>
            <td>31</td>
            <td>Testing</td>
            <td>54000</td>
            <td>17</td>
        </tr>
        <tr>
            <td>97</td>
            <td>Lucas Evans</td>
            <td>30</td>
            <td>Testing</td>
            <td>52000</td>
            <td>18</td>
        </tr>
        <tr>
            <td>118</td>
            <td>Jackson Harris</td>
            <td>33</td>
            <td>Testing</td>
            <td>50000</td>
            <td>19</td>
        </tr>
        <tr>
            <td>77</td>
            <td>Emma Thomas</td>
            <td>29</td>
            <td>Testing</td>
            <td>50000</td>
            <td>19</td>
        </tr>
        <tr>
            <td>74</td>
            <td>Sophie Scott</td>
            <td>32</td>
            <td>Testing</td>
            <td>49000</td>
            <td>21</td>
        </tr>
        <tr>
            <td>110</td>
            <td>Liam Davis</td>
            <td>34</td>
            <td>Testing</td>
            <td>48000</td>
            <td>22</td>
        </tr>
        <tr>
            <td>102</td>
            <td>Ava Robinson</td>
            <td>30</td>
            <td>Testing</td>
            <td>46000</td>
            <td>23</td>
        </tr>
        <tr>
            <td>60</td>
            <td>Chloe Scott</td>
            <td>33</td>
            <td>Testing</td>
            <td>45000</td>
            <td>24</td>
        </tr>
        <tr>
            <td>114</td>
            <td>Benjamin Carter</td>
            <td>28</td>
            <td>Testing</td>
            <td>41000</td>
            <td>25</td>
        </tr>
        <tr>
            <td>70</td>
            <td>Jack Davis</td>
            <td>36</td>
            <td>Testing</td>
            <td>35000</td>
            <td>26</td>
        </tr>
        <tr>
            <td>42</td>
            <td>Lucas Rodriguez</td>
            <td>30</td>
            <td>None</td>
            <td>80000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>61</td>
            <td>William Harris</td>
            <td>38</td>
            <td>None</td>
            <td>75000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>55</td>
            <td>Liam Johnson</td>
            <td>38</td>
            <td>None</td>
            <td>60000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>46</td>
            <td>Jack Taylor</td>
            <td>None</td>
            <td>None</td>
            <td>60000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>9</td>
            <td>James Martinez</td>
            <td>40</td>
            <td>None</td>
            <td>59000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>119</td>
            <td>Zoey Miller</td>
            <td>35</td>
            <td>None</td>
            <td>59000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>41</td>
            <td>Megan Mitchell</td>
            <td>28</td>
            <td>None</td>
            <td>55000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>21</td>
            <td>Ella Adams</td>
            <td>27</td>
            <td>None</td>
            <td>54000</td>
            <td>8</td>
        </tr>
        <tr>
            <td>106</td>
            <td>Sophia Wilson</td>
            <td>33</td>
            <td>None</td>
            <td>52000</td>
            <td>9</td>
        </tr>
    </tbody>
</table>




```python
# Ranks each (department, gender) group separately
%%sql
SELECT id, name, age, gender, department, salary, 
RANK() OVER(PARTITION BY department, gender ORDER BY salary DESC) AS rank
FROM employee WHERE salary IS NOT NULL
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>id</th>
            <th>name</th>
            <th>age</th>
            <th>gender</th>
            <th>department</th>
            <th>salary</th>
            <th>rank</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>43</td>
            <td>Sophia Hernandez</td>
            <td>33</td>
            <td>Female</td>
            <td>HR</td>
            <td>75000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>49</td>
            <td>Mia Robinson</td>
            <td>None</td>
            <td>Female</td>
            <td>HR</td>
            <td>71000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>25</td>
            <td>Chloe Walker</td>
            <td>31</td>
            <td>Female</td>
            <td>HR</td>
            <td>64000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>113</td>
            <td>Grace Martinez</td>
            <td>36</td>
            <td>Female</td>
            <td>HR</td>
            <td>61000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>115</td>
            <td>Mia Robinson</td>
            <td>31</td>
            <td>Female</td>
            <td>HR</td>
            <td>58000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>31</td>
            <td>Ava Mitchell</td>
            <td>26</td>
            <td>Female</td>
            <td>HR</td>
            <td>57000</td>
            <td>6</td>
        </tr>
        <tr>
            <td>73</td>
            <td>Chloe Lee</td>
            <td>31</td>
            <td>Female</td>
            <td>HR</td>
            <td>56000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>37</td>
            <td>Sophie Hill</td>
            <td>30</td>
            <td>Female</td>
            <td>HR</td>
            <td>56000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>104</td>
            <td>Isabella Martinez</td>
            <td>32</td>
            <td>Female</td>
            <td>HR</td>
            <td>53000</td>
            <td>9</td>
        </tr>
        <tr>
            <td>13</td>
            <td>Amelia Garcia</td>
            <td>31</td>
            <td>Female</td>
            <td>HR</td>
            <td>50000</td>
            <td>10</td>
        </tr>
        <tr>
            <td>100</td>
            <td>Chloe Brown</td>
            <td>27</td>
            <td>Female</td>
            <td>HR</td>
            <td>48000</td>
            <td>11</td>
        </tr>
        <tr>
            <td>108</td>
            <td>Madison Wright</td>
            <td>32</td>
            <td>Female</td>
            <td>HR</td>
            <td>48000</td>
            <td>11</td>
        </tr>
        <tr>
            <td>56</td>
            <td>Olivia Wright</td>
            <td>32</td>
            <td>Female</td>
            <td>HR</td>
            <td>42000</td>
            <td>13</td>
        </tr>
        <tr>
            <td>96</td>
            <td>Sophia Lee</td>
            <td>33</td>
            <td>Female</td>
            <td>HR</td>
            <td>42000</td>
            <td>13</td>
        </tr>
        <tr>
            <td>91</td>
            <td>Charlotte Anderson</td>
            <td>29</td>
            <td>Female</td>
            <td>HR</td>
            <td>35000</td>
            <td>15</td>
        </tr>
        <tr>
            <td>18</td>
            <td>Henry Clark</td>
            <td>40</td>
            <td>Male</td>
            <td>HR</td>
            <td>80000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>28</td>
            <td>Elijah Allen</td>
            <td>26</td>
            <td>Male</td>
            <td>HR</td>
            <td>58000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>1</td>
            <td>John Doe</td>
            <td>29</td>
            <td>Male</td>
            <td>HR</td>
            <td>55000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>88</td>
            <td>Jacob Lewis</td>
            <td>33</td>
            <td>Male</td>
            <td>HR</td>
            <td>54000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>59</td>
            <td>Jacob Wilson</td>
            <td>34</td>
            <td>Male</td>
            <td>HR</td>
            <td>50000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>79</td>
            <td>Elijah White</td>
            <td>32</td>
            <td>Male</td>
            <td>HR</td>
            <td>49000</td>
            <td>6</td>
        </tr>
        <tr>
            <td>68</td>
            <td>Jacob Thomas</td>
            <td>28</td>
            <td>Male</td>
            <td>HR</td>
            <td>48000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>51</td>
            <td>Lucas Walker</td>
            <td>29</td>
            <td>Male</td>
            <td>HR</td>
            <td>35000</td>
            <td>8</td>
        </tr>
        <tr>
            <td>5</td>
            <td>David Johnson</td>
            <td>32</td>
            <td>None</td>
            <td>HR</td>
            <td>75000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>76</td>
            <td>Aiden Green</td>
            <td>30</td>
            <td>None</td>
            <td>HR</td>
            <td>47000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>64</td>
            <td>Lily Adams</td>
            <td>29</td>
            <td>None</td>
            <td>HR</td>
            <td>41000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>27</td>
            <td>Charlotte King</td>
            <td>32</td>
            <td>Female</td>
            <td>Operations</td>
            <td>78000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>89</td>
            <td>Emma Turner</td>
            <td>36</td>
            <td>Female</td>
            <td>Operations</td>
            <td>69000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>98</td>
            <td>Lily Green</td>
            <td>34</td>
            <td>Female</td>
            <td>Operations</td>
            <td>65000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>17</td>
            <td>Charlotte Harris</td>
            <td>31</td>
            <td>Female</td>
            <td>Operations</td>
            <td>56000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>62</td>
            <td>Amelia Moore</td>
            <td>30</td>
            <td>Female</td>
            <td>Operations</td>
            <td>55000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>94</td>
            <td>Olivia Wilson</td>
            <td>30</td>
            <td>Female</td>
            <td>Operations</td>
            <td>53000</td>
            <td>6</td>
        </tr>
        <tr>
            <td>86</td>
            <td>Emily Mitchell</td>
            <td>29</td>
            <td>Female</td>
            <td>Operations</td>
            <td>53000</td>
            <td>6</td>
        </tr>
        <tr>
            <td>69</td>
            <td>Mia Jackson</td>
            <td>30</td>
            <td>Female</td>
            <td>Operations</td>
            <td>52000</td>
            <td>8</td>
        </tr>
        <tr>
            <td>52</td>
            <td>Megan Clark</td>
            <td>33</td>
            <td>Female</td>
            <td>Operations</td>
            <td>50000</td>
            <td>9</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Ella Harris</td>
            <td>26</td>
            <td>Female</td>
            <td>Operations</td>
            <td>46000</td>
            <td>10</td>
        </tr>
        <tr>
            <td>117</td>
            <td>Chloe Davis</td>
            <td>27</td>
            <td>Female</td>
            <td>Operations</td>
            <td>45000</td>
            <td>11</td>
        </tr>
        <tr>
            <td>83</td>
            <td>Isabella Lee</td>
            <td>28</td>
            <td>Female</td>
            <td>Operations</td>
            <td>45000</td>
            <td>11</td>
        </tr>
        <tr>
            <td>44</td>
            <td>Evan Moore</td>
            <td>40</td>
            <td>Male</td>
            <td>Operations</td>
            <td>85000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>36</td>
            <td>Liam Allen</td>
            <td>37</td>
            <td>Male</td>
            <td>Operations</td>
            <td>73000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>40</td>
            <td>Daniel Young</td>
            <td>35</td>
            <td>Male</td>
            <td>Operations</td>
            <td>70000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>72</td>
            <td>Benjamin Walker</td>
            <td>40</td>
            <td>Male</td>
            <td>Operations</td>
            <td>68000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>75</td>
            <td>Oliver Wilson</td>
            <td>33</td>
            <td>Male</td>
            <td>Operations</td>
            <td>63000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>103</td>
            <td>Elijah Turner</td>
            <td>35</td>
            <td>Male</td>
            <td>Operations</td>
            <td>55000</td>
            <td>6</td>
        </tr>
        <tr>
            <td>80</td>
            <td>Oliver Harris</td>
            <td>28</td>
            <td>Male</td>
            <td>Operations</td>
            <td>55000</td>
            <td>6</td>
        </tr>
        <tr>
            <td>66</td>
            <td>Amos King</td>
            <td>27</td>
            <td>Male</td>
            <td>Operations</td>
            <td>50000</td>
            <td>8</td>
        </tr>
        <tr>
            <td>7</td>
            <td>Michael Davis</td>
            <td>None</td>
            <td>None</td>
            <td>Operations</td>
            <td>82000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>23</td>
            <td>Lily Carter</td>
            <td>33</td>
            <td>None</td>
            <td>Operations</td>
            <td>75000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Sam Williams</td>
            <td>None</td>
            <td>None</td>
            <td>Operations</td>
            <td>73000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>107</td>
            <td>Aiden Clark</td>
            <td>29</td>
            <td>None</td>
            <td>Operations</td>
            <td>39000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>57</td>
            <td>Mason Lee</td>
            <td>26</td>
            <td>None</td>
            <td>Operations</td>
            <td>35000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>10</td>
            <td>Sophia Taylor</td>
            <td>26</td>
            <td>Female</td>
            <td>SW</td>
            <td>70000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>47</td>
            <td>Grace Brown</td>
            <td>34</td>
            <td>Female</td>
            <td>SW</td>
            <td>69000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>67</td>
            <td>Zoe Evans</td>
            <td>32</td>
            <td>Female</td>
            <td>SW</td>
            <td>65000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Jane Smith</td>
            <td>34</td>
            <td>Female</td>
            <td>SW</td>
            <td>62000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>71</td>
            <td>Ava Robinson</td>
            <td>27</td>
            <td>Female</td>
            <td>SW</td>
            <td>62000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>19</td>
            <td>Mia Young</td>
            <td>26</td>
            <td>Female</td>
            <td>SW</td>
            <td>60000</td>
            <td>6</td>
        </tr>
        <tr>
            <td>58</td>
            <td>Sophia Young</td>
            <td>29</td>
            <td>Female</td>
            <td>SW</td>
            <td>55000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>6</td>
            <td>Sarah Lee</td>
            <td>27</td>
            <td>Female</td>
            <td>SW</td>
            <td>54000</td>
            <td>8</td>
        </tr>
        <tr>
            <td>54</td>
            <td>Ava Martinez</td>
            <td>26</td>
            <td>Female</td>
            <td>SW</td>
            <td>48000</td>
            <td>9</td>
        </tr>
        <tr>
            <td>30</td>
            <td>Alexander Green</td>
            <td>41</td>
            <td>Male</td>
            <td>SW</td>
            <td>83000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>35</td>
            <td>Jack Carter</td>
            <td>None</td>
            <td>Male</td>
            <td>SW</td>
            <td>75000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>85</td>
            <td>Jack Harris</td>
            <td>40</td>
            <td>Male</td>
            <td>SW</td>
            <td>72000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>101</td>
            <td>James Johnson</td>
            <td>38</td>
            <td>Male</td>
            <td>SW</td>
            <td>70000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>63</td>
            <td>Henry Green</td>
            <td>35</td>
            <td>Male</td>
            <td>SW</td>
            <td>70000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>38</td>
            <td>Charlie Scott</td>
            <td>29</td>
            <td>Male</td>
            <td>SW</td>
            <td>68000</td>
            <td>6</td>
        </tr>
        <tr>
            <td>32</td>
            <td>Oliver Martin</td>
            <td>None</td>
            <td>Male</td>
            <td>SW</td>
            <td>66000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>82</td>
            <td>Joshua Evans</td>
            <td>27</td>
            <td>Male</td>
            <td>SW</td>
            <td>58000</td>
            <td>8</td>
        </tr>
        <tr>
            <td>105</td>
            <td>Oliver Thomas</td>
            <td>27</td>
            <td>Male</td>
            <td>SW</td>
            <td>58000</td>
            <td>8</td>
        </tr>
        <tr>
            <td>78</td>
            <td>Lucas Robinson</td>
            <td>30</td>
            <td>Male</td>
            <td>SW</td>
            <td>55000</td>
            <td>10</td>
        </tr>
        <tr>
            <td>90</td>
            <td>Ethan Scott</td>
            <td>28</td>
            <td>Male</td>
            <td>SW</td>
            <td>55000</td>
            <td>10</td>
        </tr>
        <tr>
            <td>112</td>
            <td>Isaac Nelson</td>
            <td>40</td>
            <td>Male</td>
            <td>SW</td>
            <td>55000</td>
            <td>10</td>
        </tr>
        <tr>
            <td>116</td>
            <td>Joshua Lee</td>
            <td>29</td>
            <td>Male</td>
            <td>SW</td>
            <td>49000</td>
            <td>13</td>
        </tr>
        <tr>
            <td>92</td>
            <td>Liam Carter</td>
            <td>35</td>
            <td>Male</td>
            <td>SW</td>
            <td>48000</td>
            <td>14</td>
        </tr>
        <tr>
            <td>95</td>
            <td>Benjamin Walker</td>
            <td>28</td>
            <td>Male</td>
            <td>SW</td>
            <td>47000</td>
            <td>15</td>
        </tr>
        <tr>
            <td>26</td>
            <td>Matthew Hall</td>
            <td>None</td>
            <td>None</td>
            <td>SW</td>
            <td>72000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>120</td>
            <td>Nathan Moore</td>
            <td>32</td>
            <td>None</td>
            <td>SW</td>
            <td>62000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>109</td>
            <td>Samuel Rodriguez</td>
            <td>30</td>
            <td>None</td>
            <td>SW</td>
            <td>60000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>34</td>
            <td>Ruby Harris</td>
            <td>30</td>
            <td>Female</td>
            <td>Testing</td>
            <td>71000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>29</td>
            <td>Zoe Wright</td>
            <td>29</td>
            <td>Female</td>
            <td>Testing</td>
            <td>71000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Emily Brown</td>
            <td>30</td>
            <td>Female</td>
            <td>Testing</td>
            <td>67000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Olivia Wilson</td>
            <td>25</td>
            <td>Female</td>
            <td>Testing</td>
            <td>66000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>87</td>
            <td>Ava Wilson</td>
            <td>35</td>
            <td>Female</td>
            <td>Testing</td>
            <td>65000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>15</td>
            <td>Isabella Martinez</td>
            <td>32</td>
            <td>Female</td>
            <td>Testing</td>
            <td>64000</td>
            <td>6</td>
        </tr>
        <tr>
            <td>84</td>
            <td>Zoe Walker</td>
            <td>31</td>
            <td>Female</td>
            <td>Testing</td>
            <td>62000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>81</td>
            <td>Emily Walker</td>
            <td>35</td>
            <td>Female</td>
            <td>Testing</td>
            <td>60000</td>
            <td>8</td>
        </tr>
        <tr>
            <td>77</td>
            <td>Emma Thomas</td>
            <td>29</td>
            <td>Female</td>
            <td>Testing</td>
            <td>50000</td>
            <td>9</td>
        </tr>
        <tr>
            <td>74</td>
            <td>Sophie Scott</td>
            <td>32</td>
            <td>Female</td>
            <td>Testing</td>
            <td>49000</td>
            <td>10</td>
        </tr>
        <tr>
            <td>60</td>
            <td>Chloe Scott</td>
            <td>33</td>
            <td>Female</td>
            <td>Testing</td>
            <td>45000</td>
            <td>11</td>
        </tr>
        <tr>
            <td>20</td>
            <td>Jacob Scott</td>
            <td>37</td>
            <td>Male</td>
            <td>Testing</td>
            <td>71000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>45</td>
            <td>Mason King</td>
            <td>35</td>
            <td>Male</td>
            <td>Testing</td>
            <td>67000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>12</td>
            <td>Lucas Thomas</td>
            <td>29</td>
            <td>Male</td>
            <td>Testing</td>
            <td>63000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>93</td>
            <td>Mason Harris</td>
            <td>40</td>
            <td>Male</td>
            <td>Testing</td>
            <td>62000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>65</td>
            <td>Noah Carter</td>
            <td>41</td>
            <td>Male</td>
            <td>Testing</td>
            <td>60000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>53</td>
            <td>James Turner</td>
            <td>40</td>
            <td>Male</td>
            <td>Testing</td>
            <td>55000</td>
            <td>6</td>
        </tr>
        <tr>
            <td>99</td>
            <td>Henry Scott</td>
            <td>31</td>
            <td>Male</td>
            <td>Testing</td>
            <td>54000</td>
            <td>7</td>
        </tr>
        <tr>
            <td>118</td>
            <td>Jackson Harris</td>
            <td>33</td>
            <td>Male</td>
            <td>Testing</td>
            <td>50000</td>
            <td>8</td>
        </tr>
        <tr>
            <td>110</td>
            <td>Liam Davis</td>
            <td>34</td>
            <td>Male</td>
            <td>Testing</td>
            <td>48000</td>
            <td>9</td>
        </tr>
        <tr>
            <td>70</td>
            <td>Jack Davis</td>
            <td>36</td>
            <td>Male</td>
            <td>Testing</td>
            <td>35000</td>
            <td>10</td>
        </tr>
        <tr>
            <td>48</td>
            <td>Benjamin Green</td>
            <td>38</td>
            <td>None</td>
            <td>Testing</td>
            <td>72000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>24</td>
            <td>Benjamin Lewis</td>
            <td>37</td>
            <td>None</td>
            <td>Testing</td>
            <td>69000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>97</td>
            <td>Lucas Evans</td>
            <td>30</td>
            <td>None</td>
            <td>Testing</td>
            <td>52000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>102</td>
            <td>Ava Robinson</td>
            <td>30</td>
            <td>None</td>
            <td>Testing</td>
            <td>46000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>114</td>
            <td>Benjamin Carter</td>
            <td>28</td>
            <td>None</td>
            <td>Testing</td>
            <td>41000</td>
            <td>5</td>
        </tr>
        <tr>
            <td>119</td>
            <td>Zoey Miller</td>
            <td>35</td>
            <td>Female</td>
            <td>None</td>
            <td>59000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>41</td>
            <td>Megan Mitchell</td>
            <td>28</td>
            <td>Female</td>
            <td>None</td>
            <td>55000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>21</td>
            <td>Ella Adams</td>
            <td>27</td>
            <td>Female</td>
            <td>None</td>
            <td>54000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>106</td>
            <td>Sophia Wilson</td>
            <td>33</td>
            <td>Female</td>
            <td>None</td>
            <td>52000</td>
            <td>4</td>
        </tr>
        <tr>
            <td>42</td>
            <td>Lucas Rodriguez</td>
            <td>30</td>
            <td>Male</td>
            <td>None</td>
            <td>80000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>61</td>
            <td>William Harris</td>
            <td>38</td>
            <td>Male</td>
            <td>None</td>
            <td>75000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>55</td>
            <td>Liam Johnson</td>
            <td>38</td>
            <td>Male</td>
            <td>None</td>
            <td>60000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>46</td>
            <td>Jack Taylor</td>
            <td>None</td>
            <td>Male</td>
            <td>None</td>
            <td>60000</td>
            <td>3</td>
        </tr>
        <tr>
            <td>9</td>
            <td>James Martinez</td>
            <td>40</td>
            <td>Male</td>
            <td>None</td>
            <td>59000</td>
            <td>5</td>
        </tr>
    </tbody>
</table>



### Using RANK() to find out Top 3 people with highest salaries
### in each department



```sql
%%sql
WITH cte AS
(
    SELECT id, name, age, gender, department, salary,
    RANK() OVER(PARTITION BY department ORDER BY salary DESC) AS rank
    FROM employee WHERE salary IS NOT NULL
)
SELECT * FROM cte WHERE rank < 3
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>id</th>
            <th>name</th>
            <th>age</th>
            <th>gender</th>
            <th>department</th>
            <th>salary</th>
            <th>rank</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>18</td>
            <td>Henry Clark</td>
            <td>40</td>
            <td>Male</td>
            <td>HR</td>
            <td>80000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>43</td>
            <td>Sophia Hernandez</td>
            <td>33</td>
            <td>Female</td>
            <td>HR</td>
            <td>75000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>5</td>
            <td>David Johnson</td>
            <td>32</td>
            <td>None</td>
            <td>HR</td>
            <td>75000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>44</td>
            <td>Evan Moore</td>
            <td>40</td>
            <td>Male</td>
            <td>Operations</td>
            <td>85000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>7</td>
            <td>Michael Davis</td>
            <td>None</td>
            <td>None</td>
            <td>Operations</td>
            <td>82000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>30</td>
            <td>Alexander Green</td>
            <td>41</td>
            <td>Male</td>
            <td>SW</td>
            <td>83000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>35</td>
            <td>Jack Carter</td>
            <td>None</td>
            <td>Male</td>
            <td>SW</td>
            <td>75000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>48</td>
            <td>Benjamin Green</td>
            <td>38</td>
            <td>None</td>
            <td>Testing</td>
            <td>72000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>34</td>
            <td>Ruby Harris</td>
            <td>30</td>
            <td>Female</td>
            <td>Testing</td>
            <td>71000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>29</td>
            <td>Zoe Wright</td>
            <td>29</td>
            <td>Female</td>
            <td>Testing</td>
            <td>71000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>20</td>
            <td>Jacob Scott</td>
            <td>37</td>
            <td>Male</td>
            <td>Testing</td>
            <td>71000</td>
            <td>2</td>
        </tr>
        <tr>
            <td>42</td>
            <td>Lucas Rodriguez</td>
            <td>30</td>
            <td>Male</td>
            <td>None</td>
            <td>80000</td>
            <td>1</td>
        </tr>
        <tr>
            <td>61</td>
            <td>William Harris</td>
            <td>38</td>
            <td>Male</td>
            <td>None</td>
            <td>75000</td>
            <td>2</td>
        </tr>
    </tbody>
</table>




```python

```


```sql
%%sql
SELECT department, COUNT(*), SUM(age), AVG(salary)
FROM employee
GROUP BY department
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>department</th>
            <th>COUNT(*)</th>
            <th>SUM(AGE)</th>
            <th>AVG(SALARY)</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Operations</td>
            <td>27</td>
            <td>793</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>SW</td>
            <td>28</td>
            <td>780</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>Testing</td>
            <td>27</td>
            <td>892</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>HR</td>
            <td>26</td>
            <td>776</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>None</td>
            <td>12</td>
            <td>360</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
    </tbody>
</table>



## ROW_NUMBER()
- Used to give a unique sequential number to each row  
  obtained as a result of a select query


```sql
%%sql
SELECT id, name, age, salary, department,
ROW_NUMBER() OVER(ORDER BY salary DESC) as rn
FROM employee WHERE salary  IS NOT NULL
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>id</th>
            <th>name</th>
            <th>age</th>
            <th>salary</th>
            <th>department</th>
            <th>rn</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>44</td>
            <td>Evan Moore</td>
            <td>40</td>
            <td>85000</td>
            <td>Operations</td>
            <td>1</td>
        </tr>
        <tr>
            <td>30</td>
            <td>Alexander Green</td>
            <td>41</td>
            <td>83000</td>
            <td>SW</td>
            <td>2</td>
        </tr>
        <tr>
            <td>7</td>
            <td>Michael Davis</td>
            <td>None</td>
            <td>82000</td>
            <td>Operations</td>
            <td>3</td>
        </tr>
        <tr>
            <td>42</td>
            <td>Lucas Rodriguez</td>
            <td>30</td>
            <td>80000</td>
            <td>None</td>
            <td>4</td>
        </tr>
        <tr>
            <td>18</td>
            <td>Henry Clark</td>
            <td>40</td>
            <td>80000</td>
            <td>HR</td>
            <td>5</td>
        </tr>
        <tr>
            <td>27</td>
            <td>Charlotte King</td>
            <td>32</td>
            <td>78000</td>
            <td>Operations</td>
            <td>6</td>
        </tr>
        <tr>
            <td>5</td>
            <td>David Johnson</td>
            <td>32</td>
            <td>75000</td>
            <td>HR</td>
            <td>7</td>
        </tr>
        <tr>
            <td>35</td>
            <td>Jack Carter</td>
            <td>None</td>
            <td>75000</td>
            <td>SW</td>
            <td>8</td>
        </tr>
        <tr>
            <td>61</td>
            <td>William Harris</td>
            <td>38</td>
            <td>75000</td>
            <td>None</td>
            <td>9</td>
        </tr>
        <tr>
            <td>23</td>
            <td>Lily Carter</td>
            <td>33</td>
            <td>75000</td>
            <td>Operations</td>
            <td>10</td>
        </tr>
        <tr>
            <td>43</td>
            <td>Sophia Hernandez</td>
            <td>33</td>
            <td>75000</td>
            <td>HR</td>
            <td>11</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Sam Williams</td>
            <td>None</td>
            <td>73000</td>
            <td>Operations</td>
            <td>12</td>
        </tr>
        <tr>
            <td>36</td>
            <td>Liam Allen</td>
            <td>37</td>
            <td>73000</td>
            <td>Operations</td>
            <td>13</td>
        </tr>
        <tr>
            <td>85</td>
            <td>Jack Harris</td>
            <td>40</td>
            <td>72000</td>
            <td>SW</td>
            <td>14</td>
        </tr>
        <tr>
            <td>26</td>
            <td>Matthew Hall</td>
            <td>None</td>
            <td>72000</td>
            <td>SW</td>
            <td>15</td>
        </tr>
        <tr>
            <td>48</td>
            <td>Benjamin Green</td>
            <td>38</td>
            <td>72000</td>
            <td>Testing</td>
            <td>16</td>
        </tr>
        <tr>
            <td>20</td>
            <td>Jacob Scott</td>
            <td>37</td>
            <td>71000</td>
            <td>Testing</td>
            <td>17</td>
        </tr>
        <tr>
            <td>29</td>
            <td>Zoe Wright</td>
            <td>29</td>
            <td>71000</td>
            <td>Testing</td>
            <td>18</td>
        </tr>
        <tr>
            <td>34</td>
            <td>Ruby Harris</td>
            <td>30</td>
            <td>71000</td>
            <td>Testing</td>
            <td>19</td>
        </tr>
        <tr>
            <td>49</td>
            <td>Mia Robinson</td>
            <td>None</td>
            <td>71000</td>
            <td>HR</td>
            <td>20</td>
        </tr>
        <tr>
            <td>101</td>
            <td>James Johnson</td>
            <td>38</td>
            <td>70000</td>
            <td>SW</td>
            <td>21</td>
        </tr>
        <tr>
            <td>10</td>
            <td>Sophia Taylor</td>
            <td>26</td>
            <td>70000</td>
            <td>SW</td>
            <td>22</td>
        </tr>
        <tr>
            <td>63</td>
            <td>Henry Green</td>
            <td>35</td>
            <td>70000</td>
            <td>SW</td>
            <td>23</td>
        </tr>
        <tr>
            <td>40</td>
            <td>Daniel Young</td>
            <td>35</td>
            <td>70000</td>
            <td>Operations</td>
            <td>24</td>
        </tr>
        <tr>
            <td>24</td>
            <td>Benjamin Lewis</td>
            <td>37</td>
            <td>69000</td>
            <td>Testing</td>
            <td>25</td>
        </tr>
        <tr>
            <td>89</td>
            <td>Emma Turner</td>
            <td>36</td>
            <td>69000</td>
            <td>Operations</td>
            <td>26</td>
        </tr>
        <tr>
            <td>47</td>
            <td>Grace Brown</td>
            <td>34</td>
            <td>69000</td>
            <td>SW</td>
            <td>27</td>
        </tr>
        <tr>
            <td>38</td>
            <td>Charlie Scott</td>
            <td>29</td>
            <td>68000</td>
            <td>SW</td>
            <td>28</td>
        </tr>
        <tr>
            <td>72</td>
            <td>Benjamin Walker</td>
            <td>40</td>
            <td>68000</td>
            <td>Operations</td>
            <td>29</td>
        </tr>
        <tr>
            <td>45</td>
            <td>Mason King</td>
            <td>35</td>
            <td>67000</td>
            <td>Testing</td>
            <td>30</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Emily Brown</td>
            <td>30</td>
            <td>67000</td>
            <td>Testing</td>
            <td>31</td>
        </tr>
        <tr>
            <td>32</td>
            <td>Oliver Martin</td>
            <td>None</td>
            <td>66000</td>
            <td>SW</td>
            <td>32</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Olivia Wilson</td>
            <td>25</td>
            <td>66000</td>
            <td>Testing</td>
            <td>33</td>
        </tr>
        <tr>
            <td>98</td>
            <td>Lily Green</td>
            <td>34</td>
            <td>65000</td>
            <td>Operations</td>
            <td>34</td>
        </tr>
        <tr>
            <td>67</td>
            <td>Zoe Evans</td>
            <td>32</td>
            <td>65000</td>
            <td>SW</td>
            <td>35</td>
        </tr>
        <tr>
            <td>87</td>
            <td>Ava Wilson</td>
            <td>35</td>
            <td>65000</td>
            <td>Testing</td>
            <td>36</td>
        </tr>
        <tr>
            <td>15</td>
            <td>Isabella Martinez</td>
            <td>32</td>
            <td>64000</td>
            <td>Testing</td>
            <td>37</td>
        </tr>
        <tr>
            <td>25</td>
            <td>Chloe Walker</td>
            <td>31</td>
            <td>64000</td>
            <td>HR</td>
            <td>38</td>
        </tr>
        <tr>
            <td>12</td>
            <td>Lucas Thomas</td>
            <td>29</td>
            <td>63000</td>
            <td>Testing</td>
            <td>39</td>
        </tr>
        <tr>
            <td>75</td>
            <td>Oliver Wilson</td>
            <td>33</td>
            <td>63000</td>
            <td>Operations</td>
            <td>40</td>
        </tr>
        <tr>
            <td>93</td>
            <td>Mason Harris</td>
            <td>40</td>
            <td>62000</td>
            <td>Testing</td>
            <td>41</td>
        </tr>
        <tr>
            <td>71</td>
            <td>Ava Robinson</td>
            <td>27</td>
            <td>62000</td>
            <td>SW</td>
            <td>42</td>
        </tr>
        <tr>
            <td>84</td>
            <td>Zoe Walker</td>
            <td>31</td>
            <td>62000</td>
            <td>Testing</td>
            <td>43</td>
        </tr>
        <tr>
            <td>120</td>
            <td>Nathan Moore</td>
            <td>32</td>
            <td>62000</td>
            <td>SW</td>
            <td>44</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Jane Smith</td>
            <td>34</td>
            <td>62000</td>
            <td>SW</td>
            <td>45</td>
        </tr>
        <tr>
            <td>113</td>
            <td>Grace Martinez</td>
            <td>36</td>
            <td>61000</td>
            <td>HR</td>
            <td>46</td>
        </tr>
        <tr>
            <td>65</td>
            <td>Noah Carter</td>
            <td>41</td>
            <td>60000</td>
            <td>Testing</td>
            <td>47</td>
        </tr>
        <tr>
            <td>55</td>
            <td>Liam Johnson</td>
            <td>38</td>
            <td>60000</td>
            <td>None</td>
            <td>48</td>
        </tr>
        <tr>
            <td>19</td>
            <td>Mia Young</td>
            <td>26</td>
            <td>60000</td>
            <td>SW</td>
            <td>49</td>
        </tr>
        <tr>
            <td>109</td>
            <td>Samuel Rodriguez</td>
            <td>30</td>
            <td>60000</td>
            <td>SW</td>
            <td>50</td>
        </tr>
        <tr>
            <td>46</td>
            <td>Jack Taylor</td>
            <td>None</td>
            <td>60000</td>
            <td>None</td>
            <td>51</td>
        </tr>
        <tr>
            <td>81</td>
            <td>Emily Walker</td>
            <td>35</td>
            <td>60000</td>
            <td>Testing</td>
            <td>52</td>
        </tr>
        <tr>
            <td>119</td>
            <td>Zoey Miller</td>
            <td>35</td>
            <td>59000</td>
            <td>None</td>
            <td>53</td>
        </tr>
        <tr>
            <td>9</td>
            <td>James Martinez</td>
            <td>40</td>
            <td>59000</td>
            <td>None</td>
            <td>54</td>
        </tr>
        <tr>
            <td>115</td>
            <td>Mia Robinson</td>
            <td>31</td>
            <td>58000</td>
            <td>HR</td>
            <td>55</td>
        </tr>
        <tr>
            <td>105</td>
            <td>Oliver Thomas</td>
            <td>27</td>
            <td>58000</td>
            <td>SW</td>
            <td>56</td>
        </tr>
        <tr>
            <td>82</td>
            <td>Joshua Evans</td>
            <td>27</td>
            <td>58000</td>
            <td>SW</td>
            <td>57</td>
        </tr>
        <tr>
            <td>28</td>
            <td>Elijah Allen</td>
            <td>26</td>
            <td>58000</td>
            <td>HR</td>
            <td>58</td>
        </tr>
        <tr>
            <td>31</td>
            <td>Ava Mitchell</td>
            <td>26</td>
            <td>57000</td>
            <td>HR</td>
            <td>59</td>
        </tr>
        <tr>
            <td>17</td>
            <td>Charlotte Harris</td>
            <td>31</td>
            <td>56000</td>
            <td>Operations</td>
            <td>60</td>
        </tr>
        <tr>
            <td>37</td>
            <td>Sophie Hill</td>
            <td>30</td>
            <td>56000</td>
            <td>HR</td>
            <td>61</td>
        </tr>
        <tr>
            <td>73</td>
            <td>Chloe Lee</td>
            <td>31</td>
            <td>56000</td>
            <td>HR</td>
            <td>62</td>
        </tr>
        <tr>
            <td>58</td>
            <td>Sophia Young</td>
            <td>29</td>
            <td>55000</td>
            <td>SW</td>
            <td>63</td>
        </tr>
        <tr>
            <td>112</td>
            <td>Isaac Nelson</td>
            <td>40</td>
            <td>55000</td>
            <td>SW</td>
            <td>64</td>
        </tr>
        <tr>
            <td>103</td>
            <td>Elijah Turner</td>
            <td>35</td>
            <td>55000</td>
            <td>Operations</td>
            <td>65</td>
        </tr>
        <tr>
            <td>1</td>
            <td>John Doe</td>
            <td>29</td>
            <td>55000</td>
            <td>HR</td>
            <td>66</td>
        </tr>
        <tr>
            <td>62</td>
            <td>Amelia Moore</td>
            <td>30</td>
            <td>55000</td>
            <td>Operations</td>
            <td>67</td>
        </tr>
        <tr>
            <td>90</td>
            <td>Ethan Scott</td>
            <td>28</td>
            <td>55000</td>
            <td>SW</td>
            <td>68</td>
        </tr>
        <tr>
            <td>80</td>
            <td>Oliver Harris</td>
            <td>28</td>
            <td>55000</td>
            <td>Operations</td>
            <td>69</td>
        </tr>
        <tr>
            <td>53</td>
            <td>James Turner</td>
            <td>40</td>
            <td>55000</td>
            <td>Testing</td>
            <td>70</td>
        </tr>
        <tr>
            <td>78</td>
            <td>Lucas Robinson</td>
            <td>30</td>
            <td>55000</td>
            <td>SW</td>
            <td>71</td>
        </tr>
        <tr>
            <td>41</td>
            <td>Megan Mitchell</td>
            <td>28</td>
            <td>55000</td>
            <td>None</td>
            <td>72</td>
        </tr>
        <tr>
            <td>21</td>
            <td>Ella Adams</td>
            <td>27</td>
            <td>54000</td>
            <td>None</td>
            <td>73</td>
        </tr>
        <tr>
            <td>6</td>
            <td>Sarah Lee</td>
            <td>27</td>
            <td>54000</td>
            <td>SW</td>
            <td>74</td>
        </tr>
        <tr>
            <td>99</td>
            <td>Henry Scott</td>
            <td>31</td>
            <td>54000</td>
            <td>Testing</td>
            <td>75</td>
        </tr>
        <tr>
            <td>88</td>
            <td>Jacob Lewis</td>
            <td>33</td>
            <td>54000</td>
            <td>HR</td>
            <td>76</td>
        </tr>
        <tr>
            <td>86</td>
            <td>Emily Mitchell</td>
            <td>29</td>
            <td>53000</td>
            <td>Operations</td>
            <td>77</td>
        </tr>
        <tr>
            <td>104</td>
            <td>Isabella Martinez</td>
            <td>32</td>
            <td>53000</td>
            <td>HR</td>
            <td>78</td>
        </tr>
        <tr>
            <td>94</td>
            <td>Olivia Wilson</td>
            <td>30</td>
            <td>53000</td>
            <td>Operations</td>
            <td>79</td>
        </tr>
        <tr>
            <td>106</td>
            <td>Sophia Wilson</td>
            <td>33</td>
            <td>52000</td>
            <td>None</td>
            <td>80</td>
        </tr>
        <tr>
            <td>97</td>
            <td>Lucas Evans</td>
            <td>30</td>
            <td>52000</td>
            <td>Testing</td>
            <td>81</td>
        </tr>
        <tr>
            <td>69</td>
            <td>Mia Jackson</td>
            <td>30</td>
            <td>52000</td>
            <td>Operations</td>
            <td>82</td>
        </tr>
        <tr>
            <td>66</td>
            <td>Amos King</td>
            <td>27</td>
            <td>50000</td>
            <td>Operations</td>
            <td>83</td>
        </tr>
        <tr>
            <td>59</td>
            <td>Jacob Wilson</td>
            <td>34</td>
            <td>50000</td>
            <td>HR</td>
            <td>84</td>
        </tr>
        <tr>
            <td>118</td>
            <td>Jackson Harris</td>
            <td>33</td>
            <td>50000</td>
            <td>Testing</td>
            <td>85</td>
        </tr>
        <tr>
            <td>13</td>
            <td>Amelia Garcia</td>
            <td>31</td>
            <td>50000</td>
            <td>HR</td>
            <td>86</td>
        </tr>
        <tr>
            <td>52</td>
            <td>Megan Clark</td>
            <td>33</td>
            <td>50000</td>
            <td>Operations</td>
            <td>87</td>
        </tr>
        <tr>
            <td>77</td>
            <td>Emma Thomas</td>
            <td>29</td>
            <td>50000</td>
            <td>Testing</td>
            <td>88</td>
        </tr>
        <tr>
            <td>79</td>
            <td>Elijah White</td>
            <td>32</td>
            <td>49000</td>
            <td>HR</td>
            <td>89</td>
        </tr>
        <tr>
            <td>116</td>
            <td>Joshua Lee</td>
            <td>29</td>
            <td>49000</td>
            <td>SW</td>
            <td>90</td>
        </tr>
        <tr>
            <td>74</td>
            <td>Sophie Scott</td>
            <td>32</td>
            <td>49000</td>
            <td>Testing</td>
            <td>91</td>
        </tr>
        <tr>
            <td>108</td>
            <td>Madison Wright</td>
            <td>32</td>
            <td>48000</td>
            <td>HR</td>
            <td>92</td>
        </tr>
        <tr>
            <td>100</td>
            <td>Chloe Brown</td>
            <td>27</td>
            <td>48000</td>
            <td>HR</td>
            <td>93</td>
        </tr>
        <tr>
            <td>110</td>
            <td>Liam Davis</td>
            <td>34</td>
            <td>48000</td>
            <td>Testing</td>
            <td>94</td>
        </tr>
        <tr>
            <td>54</td>
            <td>Ava Martinez</td>
            <td>26</td>
            <td>48000</td>
            <td>SW</td>
            <td>95</td>
        </tr>
        <tr>
            <td>92</td>
            <td>Liam Carter</td>
            <td>35</td>
            <td>48000</td>
            <td>SW</td>
            <td>96</td>
        </tr>
        <tr>
            <td>68</td>
            <td>Jacob Thomas</td>
            <td>28</td>
            <td>48000</td>
            <td>HR</td>
            <td>97</td>
        </tr>
        <tr>
            <td>76</td>
            <td>Aiden Green</td>
            <td>30</td>
            <td>47000</td>
            <td>HR</td>
            <td>98</td>
        </tr>
        <tr>
            <td>95</td>
            <td>Benjamin Walker</td>
            <td>28</td>
            <td>47000</td>
            <td>SW</td>
            <td>99</td>
        </tr>
        <tr>
            <td>102</td>
            <td>Ava Robinson</td>
            <td>30</td>
            <td>46000</td>
            <td>Testing</td>
            <td>100</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Ella Harris</td>
            <td>26</td>
            <td>46000</td>
            <td>Operations</td>
            <td>101</td>
        </tr>
        <tr>
            <td>83</td>
            <td>Isabella Lee</td>
            <td>28</td>
            <td>45000</td>
            <td>Operations</td>
            <td>102</td>
        </tr>
        <tr>
            <td>60</td>
            <td>Chloe Scott</td>
            <td>33</td>
            <td>45000</td>
            <td>Testing</td>
            <td>103</td>
        </tr>
        <tr>
            <td>117</td>
            <td>Chloe Davis</td>
            <td>27</td>
            <td>45000</td>
            <td>Operations</td>
            <td>104</td>
        </tr>
        <tr>
            <td>96</td>
            <td>Sophia Lee</td>
            <td>33</td>
            <td>42000</td>
            <td>HR</td>
            <td>105</td>
        </tr>
        <tr>
            <td>56</td>
            <td>Olivia Wright</td>
            <td>32</td>
            <td>42000</td>
            <td>HR</td>
            <td>106</td>
        </tr>
        <tr>
            <td>64</td>
            <td>Lily Adams</td>
            <td>29</td>
            <td>41000</td>
            <td>HR</td>
            <td>107</td>
        </tr>
        <tr>
            <td>114</td>
            <td>Benjamin Carter</td>
            <td>28</td>
            <td>41000</td>
            <td>Testing</td>
            <td>108</td>
        </tr>
        <tr>
            <td>107</td>
            <td>Aiden Clark</td>
            <td>29</td>
            <td>39000</td>
            <td>Operations</td>
            <td>109</td>
        </tr>
        <tr>
            <td>51</td>
            <td>Lucas Walker</td>
            <td>29</td>
            <td>35000</td>
            <td>HR</td>
            <td>110</td>
        </tr>
        <tr>
            <td>57</td>
            <td>Mason Lee</td>
            <td>26</td>
            <td>35000</td>
            <td>Operations</td>
            <td>111</td>
        </tr>
        <tr>
            <td>70</td>
            <td>Jack Davis</td>
            <td>36</td>
            <td>35000</td>
            <td>Testing</td>
            <td>112</td>
        </tr>
        <tr>
            <td>91</td>
            <td>Charlotte Anderson</td>
            <td>29</td>
            <td>35000</td>
            <td>HR</td>
            <td>113</td>
        </tr>
    </tbody>
</table>




```sql
%%sql
SELECT id, name, age, salary, department,
ROW_NUMBER() OVER(PARTITION BY department ORDER BY salary DESC) as rn
FROM employee WHERE salary IS NOT NULL AND rn = 7
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    (oracledb.exceptions.DatabaseError) ORA-00904: "RN": invalid identifier
    Help: https://docs.oracle.com/error-help/db/ora-00904/
    [SQL: SELECT id, name, age, salary, department,
    ROW_NUMBER() OVER(PARTITION BY department ORDER BY salary DESC) as rn
    FROM employee WHERE salary IS NOT NULL AND rn = 7]
    (Background on this error at: https://sqlalche.me/e/20/4xp6)
    


```sql
%%sql
WITH cte AS 
(
    SELECT id, name, age, salary, department,
    ROW_NUMBER() OVER(PARTITION BY department ORDER BY salary DESC) as rn
    FROM employee WHERE salary IS NOT NULL
)
SELECT * FROM cte WHERE rn = 7
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>id</th>
            <th>name</th>
            <th>age</th>
            <th>salary</th>
            <th>department</th>
            <th>rn</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>28</td>
            <td>Elijah Allen</td>
            <td>26</td>
            <td>58000</td>
            <td>HR</td>
            <td>7</td>
        </tr>
        <tr>
            <td>40</td>
            <td>Daniel Young</td>
            <td>35</td>
            <td>70000</td>
            <td>Operations</td>
            <td>7</td>
        </tr>
        <tr>
            <td>63</td>
            <td>Henry Green</td>
            <td>35</td>
            <td>70000</td>
            <td>SW</td>
            <td>7</td>
        </tr>
        <tr>
            <td>45</td>
            <td>Mason King</td>
            <td>35</td>
            <td>67000</td>
            <td>Testing</td>
            <td>7</td>
        </tr>
        <tr>
            <td>41</td>
            <td>Megan Mitchell</td>
            <td>28</td>
            <td>55000</td>
            <td>None</td>
            <td>7</td>
        </tr>
    </tbody>
</table>



## Aggregate Functions can also be used as window functions
- AVG(), SUM(), MIN(), MAX(), COUNT()
- They can be paired with PARTITION BY to apply statistics on different groups
- Using them with order by helps us compute the running values of a specific column

## Find out the average salary of all the employees in the employee table


```sql
%%sql
SELECT AVG(salary) FROM employee
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>AVG(SALARY)</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>58716.8141592920353982300884955752212389</td>
        </tr>
    </tbody>
</table>



## Find out the avg salary departmentwise for each department


```sql
%%sql
SELECT department, AVG(salary)
FROM employee
GROUP BY department
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>department</th>
            <th>AVG(SALARY)</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Operations</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>SW</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>Testing</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>HR</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>None</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
    </tbody>
</table>




```sql
%%sql
SELECT id, name, salary, department FROM employee WHERE department = 'SW' ORDER BY salary DESC
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>id</th>
            <th>name</th>
            <th>salary</th>
            <th>department</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>22</td>
            <td>Aiden Robinson</td>
            <td>None</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>30</td>
            <td>Alexander Green</td>
            <td>83000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>35</td>
            <td>Jack Carter</td>
            <td>75000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>85</td>
            <td>Jack Harris</td>
            <td>72000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>26</td>
            <td>Matthew Hall</td>
            <td>72000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>10</td>
            <td>Sophia Taylor</td>
            <td>70000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>63</td>
            <td>Henry Green</td>
            <td>70000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>101</td>
            <td>James Johnson</td>
            <td>70000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>47</td>
            <td>Grace Brown</td>
            <td>69000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>38</td>
            <td>Charlie Scott</td>
            <td>68000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>32</td>
            <td>Oliver Martin</td>
            <td>66000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>67</td>
            <td>Zoe Evans</td>
            <td>65000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>120</td>
            <td>Nathan Moore</td>
            <td>62000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>71</td>
            <td>Ava Robinson</td>
            <td>62000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Jane Smith</td>
            <td>62000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>109</td>
            <td>Samuel Rodriguez</td>
            <td>60000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>19</td>
            <td>Mia Young</td>
            <td>60000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>105</td>
            <td>Oliver Thomas</td>
            <td>58000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>82</td>
            <td>Joshua Evans</td>
            <td>58000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>90</td>
            <td>Ethan Scott</td>
            <td>55000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>78</td>
            <td>Lucas Robinson</td>
            <td>55000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>58</td>
            <td>Sophia Young</td>
            <td>55000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>112</td>
            <td>Isaac Nelson</td>
            <td>55000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>6</td>
            <td>Sarah Lee</td>
            <td>54000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>116</td>
            <td>Joshua Lee</td>
            <td>49000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>92</td>
            <td>Liam Carter</td>
            <td>48000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>54</td>
            <td>Ava Martinez</td>
            <td>48000</td>
            <td>SW</td>
        </tr>
        <tr>
            <td>95</td>
            <td>Benjamin Walker</td>
            <td>47000</td>
            <td>SW</td>
        </tr>
    </tbody>
</table>



## Find out only the employees earning more than the avarage salary 
## of their department
- JOINS
- Correlated Subquery
- Window Functions


```sql
%%sql
SELECT id, name, department, salary,
AVG(salary) OVER(PARTITION BY department) AS dept_avg_salary
FROM employee
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>id</th>
            <th>name</th>
            <th>department</th>
            <th>salary</th>
            <th>dept_avg_salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>64</td>
            <td>Lily Adams</td>
            <td>HR</td>
            <td>41000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>115</td>
            <td>Mia Robinson</td>
            <td>HR</td>
            <td>58000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>113</td>
            <td>Grace Martinez</td>
            <td>HR</td>
            <td>61000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>108</td>
            <td>Madison Wright</td>
            <td>HR</td>
            <td>48000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>104</td>
            <td>Isabella Martinez</td>
            <td>HR</td>
            <td>53000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>100</td>
            <td>Chloe Brown</td>
            <td>HR</td>
            <td>48000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>96</td>
            <td>Sophia Lee</td>
            <td>HR</td>
            <td>42000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>91</td>
            <td>Charlotte Anderson</td>
            <td>HR</td>
            <td>35000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>88</td>
            <td>Jacob Lewis</td>
            <td>HR</td>
            <td>54000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>79</td>
            <td>Elijah White</td>
            <td>HR</td>
            <td>49000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>76</td>
            <td>Aiden Green</td>
            <td>HR</td>
            <td>47000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>73</td>
            <td>Chloe Lee</td>
            <td>HR</td>
            <td>56000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>68</td>
            <td>Jacob Thomas</td>
            <td>HR</td>
            <td>48000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>59</td>
            <td>Jacob Wilson</td>
            <td>HR</td>
            <td>50000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>56</td>
            <td>Olivia Wright</td>
            <td>HR</td>
            <td>42000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>51</td>
            <td>Lucas Walker</td>
            <td>HR</td>
            <td>35000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>37</td>
            <td>Sophie Hill</td>
            <td>HR</td>
            <td>56000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>31</td>
            <td>Ava Mitchell</td>
            <td>HR</td>
            <td>57000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>28</td>
            <td>Elijah Allen</td>
            <td>HR</td>
            <td>58000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>25</td>
            <td>Chloe Walker</td>
            <td>HR</td>
            <td>64000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>18</td>
            <td>Henry Clark</td>
            <td>HR</td>
            <td>80000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>13</td>
            <td>Amelia Garcia</td>
            <td>HR</td>
            <td>50000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>5</td>
            <td>David Johnson</td>
            <td>HR</td>
            <td>75000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>1</td>
            <td>John Doe</td>
            <td>HR</td>
            <td>55000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>49</td>
            <td>Mia Robinson</td>
            <td>HR</td>
            <td>71000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>43</td>
            <td>Sophia Hernandez</td>
            <td>HR</td>
            <td>75000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>117</td>
            <td>Chloe Davis</td>
            <td>Operations</td>
            <td>45000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>17</td>
            <td>Charlotte Harris</td>
            <td>Operations</td>
            <td>56000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>89</td>
            <td>Emma Turner</td>
            <td>Operations</td>
            <td>69000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>57</td>
            <td>Mason Lee</td>
            <td>Operations</td>
            <td>35000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>107</td>
            <td>Aiden Clark</td>
            <td>Operations</td>
            <td>39000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>52</td>
            <td>Megan Clark</td>
            <td>Operations</td>
            <td>50000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>86</td>
            <td>Emily Mitchell</td>
            <td>Operations</td>
            <td>53000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>50</td>
            <td>Noah Wright</td>
            <td>Operations</td>
            <td>None</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>44</td>
            <td>Evan Moore</td>
            <td>Operations</td>
            <td>85000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>40</td>
            <td>Daniel Young</td>
            <td>Operations</td>
            <td>70000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>83</td>
            <td>Isabella Lee</td>
            <td>Operations</td>
            <td>45000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>36</td>
            <td>Liam Allen</td>
            <td>Operations</td>
            <td>73000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>80</td>
            <td>Oliver Harris</td>
            <td>Operations</td>
            <td>55000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>98</td>
            <td>Lily Green</td>
            <td>Operations</td>
            <td>65000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>27</td>
            <td>Charlotte King</td>
            <td>Operations</td>
            <td>78000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Ella Harris</td>
            <td>Operations</td>
            <td>46000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>75</td>
            <td>Oliver Wilson</td>
            <td>Operations</td>
            <td>63000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>94</td>
            <td>Olivia Wilson</td>
            <td>Operations</td>
            <td>53000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>11</td>
            <td>William Anderson</td>
            <td>Operations</td>
            <td>None</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>7</td>
            <td>Michael Davis</td>
            <td>Operations</td>
            <td>82000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>72</td>
            <td>Benjamin Walker</td>
            <td>Operations</td>
            <td>68000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Sam Williams</td>
            <td>Operations</td>
            <td>73000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>69</td>
            <td>Mia Jackson</td>
            <td>Operations</td>
            <td>52000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>103</td>
            <td>Elijah Turner</td>
            <td>Operations</td>
            <td>55000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>66</td>
            <td>Amos King</td>
            <td>Operations</td>
            <td>50000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>23</td>
            <td>Lily Carter</td>
            <td>Operations</td>
            <td>75000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>62</td>
            <td>Amelia Moore</td>
            <td>Operations</td>
            <td>55000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>26</td>
            <td>Matthew Hall</td>
            <td>SW</td>
            <td>72000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>30</td>
            <td>Alexander Green</td>
            <td>SW</td>
            <td>83000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Jane Smith</td>
            <td>SW</td>
            <td>62000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>6</td>
            <td>Sarah Lee</td>
            <td>SW</td>
            <td>54000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>10</td>
            <td>Sophia Taylor</td>
            <td>SW</td>
            <td>70000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>19</td>
            <td>Mia Young</td>
            <td>SW</td>
            <td>60000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>22</td>
            <td>Aiden Robinson</td>
            <td>SW</td>
            <td>None</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>32</td>
            <td>Oliver Martin</td>
            <td>SW</td>
            <td>66000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>35</td>
            <td>Jack Carter</td>
            <td>SW</td>
            <td>75000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>38</td>
            <td>Charlie Scott</td>
            <td>SW</td>
            <td>68000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>47</td>
            <td>Grace Brown</td>
            <td>SW</td>
            <td>69000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>54</td>
            <td>Ava Martinez</td>
            <td>SW</td>
            <td>48000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>58</td>
            <td>Sophia Young</td>
            <td>SW</td>
            <td>55000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>63</td>
            <td>Henry Green</td>
            <td>SW</td>
            <td>70000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>67</td>
            <td>Zoe Evans</td>
            <td>SW</td>
            <td>65000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>71</td>
            <td>Ava Robinson</td>
            <td>SW</td>
            <td>62000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>78</td>
            <td>Lucas Robinson</td>
            <td>SW</td>
            <td>55000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>82</td>
            <td>Joshua Evans</td>
            <td>SW</td>
            <td>58000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>85</td>
            <td>Jack Harris</td>
            <td>SW</td>
            <td>72000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>90</td>
            <td>Ethan Scott</td>
            <td>SW</td>
            <td>55000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>92</td>
            <td>Liam Carter</td>
            <td>SW</td>
            <td>48000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>95</td>
            <td>Benjamin Walker</td>
            <td>SW</td>
            <td>47000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>101</td>
            <td>James Johnson</td>
            <td>SW</td>
            <td>70000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>105</td>
            <td>Oliver Thomas</td>
            <td>SW</td>
            <td>58000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>109</td>
            <td>Samuel Rodriguez</td>
            <td>SW</td>
            <td>60000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>112</td>
            <td>Isaac Nelson</td>
            <td>SW</td>
            <td>55000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>116</td>
            <td>Joshua Lee</td>
            <td>SW</td>
            <td>49000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>120</td>
            <td>Nathan Moore</td>
            <td>SW</td>
            <td>62000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>34</td>
            <td>Ruby Harris</td>
            <td>Testing</td>
            <td>71000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>53</td>
            <td>James Turner</td>
            <td>Testing</td>
            <td>55000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>118</td>
            <td>Jackson Harris</td>
            <td>Testing</td>
            <td>50000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>114</td>
            <td>Benjamin Carter</td>
            <td>Testing</td>
            <td>41000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>110</td>
            <td>Liam Davis</td>
            <td>Testing</td>
            <td>48000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>102</td>
            <td>Ava Robinson</td>
            <td>Testing</td>
            <td>46000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>99</td>
            <td>Henry Scott</td>
            <td>Testing</td>
            <td>54000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>97</td>
            <td>Lucas Evans</td>
            <td>Testing</td>
            <td>52000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>93</td>
            <td>Mason Harris</td>
            <td>Testing</td>
            <td>62000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>87</td>
            <td>Ava Wilson</td>
            <td>Testing</td>
            <td>65000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>84</td>
            <td>Zoe Walker</td>
            <td>Testing</td>
            <td>62000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>81</td>
            <td>Emily Walker</td>
            <td>Testing</td>
            <td>60000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>77</td>
            <td>Emma Thomas</td>
            <td>Testing</td>
            <td>50000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Emily Brown</td>
            <td>Testing</td>
            <td>67000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Olivia Wilson</td>
            <td>Testing</td>
            <td>66000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>12</td>
            <td>Lucas Thomas</td>
            <td>Testing</td>
            <td>63000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>15</td>
            <td>Isabella Martinez</td>
            <td>Testing</td>
            <td>64000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>20</td>
            <td>Jacob Scott</td>
            <td>Testing</td>
            <td>71000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>24</td>
            <td>Benjamin Lewis</td>
            <td>Testing</td>
            <td>69000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>29</td>
            <td>Zoe Wright</td>
            <td>Testing</td>
            <td>71000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>39</td>
            <td>Alice Young</td>
            <td>Testing</td>
            <td>None</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>45</td>
            <td>Mason King</td>
            <td>Testing</td>
            <td>67000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>48</td>
            <td>Benjamin Green</td>
            <td>Testing</td>
            <td>72000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>60</td>
            <td>Chloe Scott</td>
            <td>Testing</td>
            <td>45000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>65</td>
            <td>Noah Carter</td>
            <td>Testing</td>
            <td>60000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>70</td>
            <td>Jack Davis</td>
            <td>Testing</td>
            <td>35000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>74</td>
            <td>Sophie Scott</td>
            <td>Testing</td>
            <td>49000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>119</td>
            <td>Zoey Miller</td>
            <td>None</td>
            <td>59000</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
        <tr>
            <td>61</td>
            <td>William Harris</td>
            <td>None</td>
            <td>75000</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
        <tr>
            <td>21</td>
            <td>Ella Adams</td>
            <td>None</td>
            <td>54000</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
        <tr>
            <td>106</td>
            <td>Sophia Wilson</td>
            <td>None</td>
            <td>52000</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
        <tr>
            <td>16</td>
            <td>Daniel Lee</td>
            <td>None</td>
            <td>None</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
        <tr>
            <td>46</td>
            <td>Jack Taylor</td>
            <td>None</td>
            <td>60000</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
        <tr>
            <td>14</td>
            <td>Ethan White</td>
            <td>None</td>
            <td>None</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
        <tr>
            <td>41</td>
            <td>Megan Mitchell</td>
            <td>None</td>
            <td>55000</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
        <tr>
            <td>9</td>
            <td>James Martinez</td>
            <td>None</td>
            <td>59000</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
        <tr>
            <td>55</td>
            <td>Liam Johnson</td>
            <td>None</td>
            <td>60000</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
        <tr>
            <td>33</td>
            <td>Amos Turner</td>
            <td>None</td>
            <td>None</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
        <tr>
            <td>42</td>
            <td>Lucas Rodriguez</td>
            <td>None</td>
            <td>80000</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
    </tbody>
</table>




```python
# Employee earning more than the average salary of thier department
%%sql
WITH cte AS (
    SELECT id, name, department, salary,
    AVG(salary) OVER(PARTITION BY department) AS dept_avg_salary
    FROM employee
)
SELECT * FROM cte WHERE salary > dept_avg_salary
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>id</th>
            <th>name</th>
            <th>department</th>
            <th>salary</th>
            <th>dept_avg_salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>115</td>
            <td>Mia Robinson</td>
            <td>HR</td>
            <td>58000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>113</td>
            <td>Grace Martinez</td>
            <td>HR</td>
            <td>61000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>73</td>
            <td>Chloe Lee</td>
            <td>HR</td>
            <td>56000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>37</td>
            <td>Sophie Hill</td>
            <td>HR</td>
            <td>56000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>31</td>
            <td>Ava Mitchell</td>
            <td>HR</td>
            <td>57000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>28</td>
            <td>Elijah Allen</td>
            <td>HR</td>
            <td>58000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>25</td>
            <td>Chloe Walker</td>
            <td>HR</td>
            <td>64000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>18</td>
            <td>Henry Clark</td>
            <td>HR</td>
            <td>80000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>5</td>
            <td>David Johnson</td>
            <td>HR</td>
            <td>75000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>1</td>
            <td>John Doe</td>
            <td>HR</td>
            <td>55000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>49</td>
            <td>Mia Robinson</td>
            <td>HR</td>
            <td>71000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>43</td>
            <td>Sophia Hernandez</td>
            <td>HR</td>
            <td>75000</td>
            <td>54153.8461538461538461538461538461538462</td>
        </tr>
        <tr>
            <td>89</td>
            <td>Emma Turner</td>
            <td>Operations</td>
            <td>69000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>44</td>
            <td>Evan Moore</td>
            <td>Operations</td>
            <td>85000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>40</td>
            <td>Daniel Young</td>
            <td>Operations</td>
            <td>70000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>36</td>
            <td>Liam Allen</td>
            <td>Operations</td>
            <td>73000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>98</td>
            <td>Lily Green</td>
            <td>Operations</td>
            <td>65000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>27</td>
            <td>Charlotte King</td>
            <td>Operations</td>
            <td>78000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>75</td>
            <td>Oliver Wilson</td>
            <td>Operations</td>
            <td>63000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>7</td>
            <td>Michael Davis</td>
            <td>Operations</td>
            <td>82000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>72</td>
            <td>Benjamin Walker</td>
            <td>Operations</td>
            <td>68000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Sam Williams</td>
            <td>Operations</td>
            <td>73000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>23</td>
            <td>Lily Carter</td>
            <td>Operations</td>
            <td>75000</td>
            <td>59600</td>
        </tr>
        <tr>
            <td>26</td>
            <td>Matthew Hall</td>
            <td>SW</td>
            <td>72000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>30</td>
            <td>Alexander Green</td>
            <td>SW</td>
            <td>83000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Jane Smith</td>
            <td>SW</td>
            <td>62000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>10</td>
            <td>Sophia Taylor</td>
            <td>SW</td>
            <td>70000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>32</td>
            <td>Oliver Martin</td>
            <td>SW</td>
            <td>66000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>35</td>
            <td>Jack Carter</td>
            <td>SW</td>
            <td>75000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>38</td>
            <td>Charlie Scott</td>
            <td>SW</td>
            <td>68000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>47</td>
            <td>Grace Brown</td>
            <td>SW</td>
            <td>69000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>63</td>
            <td>Henry Green</td>
            <td>SW</td>
            <td>70000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>67</td>
            <td>Zoe Evans</td>
            <td>SW</td>
            <td>65000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>71</td>
            <td>Ava Robinson</td>
            <td>SW</td>
            <td>62000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>85</td>
            <td>Jack Harris</td>
            <td>SW</td>
            <td>72000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>101</td>
            <td>James Johnson</td>
            <td>SW</td>
            <td>70000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>120</td>
            <td>Nathan Moore</td>
            <td>SW</td>
            <td>62000</td>
            <td>61777.7777777777777777777777777777777778</td>
        </tr>
        <tr>
            <td>34</td>
            <td>Ruby Harris</td>
            <td>Testing</td>
            <td>71000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>93</td>
            <td>Mason Harris</td>
            <td>Testing</td>
            <td>62000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>87</td>
            <td>Ava Wilson</td>
            <td>Testing</td>
            <td>65000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>84</td>
            <td>Zoe Walker</td>
            <td>Testing</td>
            <td>62000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>81</td>
            <td>Emily Walker</td>
            <td>Testing</td>
            <td>60000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Emily Brown</td>
            <td>Testing</td>
            <td>67000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Olivia Wilson</td>
            <td>Testing</td>
            <td>66000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>12</td>
            <td>Lucas Thomas</td>
            <td>Testing</td>
            <td>63000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>15</td>
            <td>Isabella Martinez</td>
            <td>Testing</td>
            <td>64000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>20</td>
            <td>Jacob Scott</td>
            <td>Testing</td>
            <td>71000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>24</td>
            <td>Benjamin Lewis</td>
            <td>Testing</td>
            <td>69000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>29</td>
            <td>Zoe Wright</td>
            <td>Testing</td>
            <td>71000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>45</td>
            <td>Mason King</td>
            <td>Testing</td>
            <td>67000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>48</td>
            <td>Benjamin Green</td>
            <td>Testing</td>
            <td>72000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>65</td>
            <td>Noah Carter</td>
            <td>Testing</td>
            <td>60000</td>
            <td>58269.2307692307692307692307692307692308</td>
        </tr>
        <tr>
            <td>61</td>
            <td>William Harris</td>
            <td>None</td>
            <td>75000</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
        <tr>
            <td>42</td>
            <td>Lucas Rodriguez</td>
            <td>None</td>
            <td>80000</td>
            <td>61555.5555555555555555555555555555555556</td>
        </tr>
    </tbody>
</table>



### Find out the employees with maximum salary in their department


```sql
%%sql
WITH cte AS (
    SELECT id, name, department, salary,
    MAX(salary) OVER(PARTITION BY department) AS mx_salary
    FROM employee
)
SELECT * FROM cte WHERE salary = mx_salary
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>id</th>
            <th>name</th>
            <th>department</th>
            <th>salary</th>
            <th>mx_salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>18</td>
            <td>Henry Clark</td>
            <td>HR</td>
            <td>80000</td>
            <td>80000</td>
        </tr>
        <tr>
            <td>44</td>
            <td>Evan Moore</td>
            <td>Operations</td>
            <td>85000</td>
            <td>85000</td>
        </tr>
        <tr>
            <td>30</td>
            <td>Alexander Green</td>
            <td>SW</td>
            <td>83000</td>
            <td>83000</td>
        </tr>
        <tr>
            <td>48</td>
            <td>Benjamin Green</td>
            <td>Testing</td>
            <td>72000</td>
            <td>72000</td>
        </tr>
        <tr>
            <td>42</td>
            <td>Lucas Rodriguez</td>
            <td>None</td>
            <td>80000</td>
            <td>80000</td>
        </tr>
    </tbody>
</table>




```sql
%%sql
SELECT id, name, department, salary,
SUM(salary) OVER(ORDER BY department) AS total
FROM employee WHERE salary IS NOT NULL
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>id</th>
            <th>name</th>
            <th>department</th>
            <th>salary</th>
            <th>total</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>43</td>
            <td>Sophia Hernandez</td>
            <td>HR</td>
            <td>75000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>115</td>
            <td>Mia Robinson</td>
            <td>HR</td>
            <td>58000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>1</td>
            <td>John Doe</td>
            <td>HR</td>
            <td>55000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>5</td>
            <td>David Johnson</td>
            <td>HR</td>
            <td>75000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>13</td>
            <td>Amelia Garcia</td>
            <td>HR</td>
            <td>50000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>18</td>
            <td>Henry Clark</td>
            <td>HR</td>
            <td>80000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>25</td>
            <td>Chloe Walker</td>
            <td>HR</td>
            <td>64000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>28</td>
            <td>Elijah Allen</td>
            <td>HR</td>
            <td>58000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>31</td>
            <td>Ava Mitchell</td>
            <td>HR</td>
            <td>57000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>37</td>
            <td>Sophie Hill</td>
            <td>HR</td>
            <td>56000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>51</td>
            <td>Lucas Walker</td>
            <td>HR</td>
            <td>35000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>56</td>
            <td>Olivia Wright</td>
            <td>HR</td>
            <td>42000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>59</td>
            <td>Jacob Wilson</td>
            <td>HR</td>
            <td>50000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>64</td>
            <td>Lily Adams</td>
            <td>HR</td>
            <td>41000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>68</td>
            <td>Jacob Thomas</td>
            <td>HR</td>
            <td>48000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>73</td>
            <td>Chloe Lee</td>
            <td>HR</td>
            <td>56000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>76</td>
            <td>Aiden Green</td>
            <td>HR</td>
            <td>47000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>79</td>
            <td>Elijah White</td>
            <td>HR</td>
            <td>49000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>88</td>
            <td>Jacob Lewis</td>
            <td>HR</td>
            <td>54000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>91</td>
            <td>Charlotte Anderson</td>
            <td>HR</td>
            <td>35000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>96</td>
            <td>Sophia Lee</td>
            <td>HR</td>
            <td>42000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>100</td>
            <td>Chloe Brown</td>
            <td>HR</td>
            <td>48000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>104</td>
            <td>Isabella Martinez</td>
            <td>HR</td>
            <td>53000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>108</td>
            <td>Madison Wright</td>
            <td>HR</td>
            <td>48000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>113</td>
            <td>Grace Martinez</td>
            <td>HR</td>
            <td>61000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>49</td>
            <td>Mia Robinson</td>
            <td>HR</td>
            <td>71000</td>
            <td>1408000</td>
        </tr>
        <tr>
            <td>17</td>
            <td>Charlotte Harris</td>
            <td>Operations</td>
            <td>56000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>23</td>
            <td>Lily Carter</td>
            <td>Operations</td>
            <td>75000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Sam Williams</td>
            <td>Operations</td>
            <td>73000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>7</td>
            <td>Michael Davis</td>
            <td>Operations</td>
            <td>82000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>27</td>
            <td>Charlotte King</td>
            <td>Operations</td>
            <td>78000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>36</td>
            <td>Liam Allen</td>
            <td>Operations</td>
            <td>73000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>40</td>
            <td>Daniel Young</td>
            <td>Operations</td>
            <td>70000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>44</td>
            <td>Evan Moore</td>
            <td>Operations</td>
            <td>85000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>52</td>
            <td>Megan Clark</td>
            <td>Operations</td>
            <td>50000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>57</td>
            <td>Mason Lee</td>
            <td>Operations</td>
            <td>35000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>62</td>
            <td>Amelia Moore</td>
            <td>Operations</td>
            <td>55000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>66</td>
            <td>Amos King</td>
            <td>Operations</td>
            <td>50000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>69</td>
            <td>Mia Jackson</td>
            <td>Operations</td>
            <td>52000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>72</td>
            <td>Benjamin Walker</td>
            <td>Operations</td>
            <td>68000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>75</td>
            <td>Oliver Wilson</td>
            <td>Operations</td>
            <td>63000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>80</td>
            <td>Oliver Harris</td>
            <td>Operations</td>
            <td>55000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>83</td>
            <td>Isabella Lee</td>
            <td>Operations</td>
            <td>45000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>86</td>
            <td>Emily Mitchell</td>
            <td>Operations</td>
            <td>53000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>89</td>
            <td>Emma Turner</td>
            <td>Operations</td>
            <td>69000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>94</td>
            <td>Olivia Wilson</td>
            <td>Operations</td>
            <td>53000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>98</td>
            <td>Lily Green</td>
            <td>Operations</td>
            <td>65000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>103</td>
            <td>Elijah Turner</td>
            <td>Operations</td>
            <td>55000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>107</td>
            <td>Aiden Clark</td>
            <td>Operations</td>
            <td>39000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>111</td>
            <td>Ella Harris</td>
            <td>Operations</td>
            <td>46000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>117</td>
            <td>Chloe Davis</td>
            <td>Operations</td>
            <td>45000</td>
            <td>2898000</td>
        </tr>
        <tr>
            <td>105</td>
            <td>Oliver Thomas</td>
            <td>SW</td>
            <td>58000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>54</td>
            <td>Ava Martinez</td>
            <td>SW</td>
            <td>48000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>47</td>
            <td>Grace Brown</td>
            <td>SW</td>
            <td>69000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>10</td>
            <td>Sophia Taylor</td>
            <td>SW</td>
            <td>70000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>95</td>
            <td>Benjamin Walker</td>
            <td>SW</td>
            <td>47000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Jane Smith</td>
            <td>SW</td>
            <td>62000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>92</td>
            <td>Liam Carter</td>
            <td>SW</td>
            <td>48000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>90</td>
            <td>Ethan Scott</td>
            <td>SW</td>
            <td>55000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>26</td>
            <td>Matthew Hall</td>
            <td>SW</td>
            <td>72000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>85</td>
            <td>Jack Harris</td>
            <td>SW</td>
            <td>72000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>38</td>
            <td>Charlie Scott</td>
            <td>SW</td>
            <td>68000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>82</td>
            <td>Joshua Evans</td>
            <td>SW</td>
            <td>58000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>35</td>
            <td>Jack Carter</td>
            <td>SW</td>
            <td>75000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>78</td>
            <td>Lucas Robinson</td>
            <td>SW</td>
            <td>55000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>32</td>
            <td>Oliver Martin</td>
            <td>SW</td>
            <td>66000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>30</td>
            <td>Alexander Green</td>
            <td>SW</td>
            <td>83000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>71</td>
            <td>Ava Robinson</td>
            <td>SW</td>
            <td>62000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>6</td>
            <td>Sarah Lee</td>
            <td>SW</td>
            <td>54000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>67</td>
            <td>Zoe Evans</td>
            <td>SW</td>
            <td>65000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>109</td>
            <td>Samuel Rodriguez</td>
            <td>SW</td>
            <td>60000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>63</td>
            <td>Henry Green</td>
            <td>SW</td>
            <td>70000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>120</td>
            <td>Nathan Moore</td>
            <td>SW</td>
            <td>62000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>116</td>
            <td>Joshua Lee</td>
            <td>SW</td>
            <td>49000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>58</td>
            <td>Sophia Young</td>
            <td>SW</td>
            <td>55000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>19</td>
            <td>Mia Young</td>
            <td>SW</td>
            <td>60000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>112</td>
            <td>Isaac Nelson</td>
            <td>SW</td>
            <td>55000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>101</td>
            <td>James Johnson</td>
            <td>SW</td>
            <td>70000</td>
            <td>4566000</td>
        </tr>
        <tr>
            <td>102</td>
            <td>Ava Robinson</td>
            <td>Testing</td>
            <td>46000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>99</td>
            <td>Henry Scott</td>
            <td>Testing</td>
            <td>54000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>97</td>
            <td>Lucas Evans</td>
            <td>Testing</td>
            <td>52000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>93</td>
            <td>Mason Harris</td>
            <td>Testing</td>
            <td>62000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>87</td>
            <td>Ava Wilson</td>
            <td>Testing</td>
            <td>65000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>84</td>
            <td>Zoe Walker</td>
            <td>Testing</td>
            <td>62000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>81</td>
            <td>Emily Walker</td>
            <td>Testing</td>
            <td>60000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>77</td>
            <td>Emma Thomas</td>
            <td>Testing</td>
            <td>50000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>74</td>
            <td>Sophie Scott</td>
            <td>Testing</td>
            <td>49000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>70</td>
            <td>Jack Davis</td>
            <td>Testing</td>
            <td>35000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>65</td>
            <td>Noah Carter</td>
            <td>Testing</td>
            <td>60000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>60</td>
            <td>Chloe Scott</td>
            <td>Testing</td>
            <td>45000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Emily Brown</td>
            <td>Testing</td>
            <td>67000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>53</td>
            <td>James Turner</td>
            <td>Testing</td>
            <td>55000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>48</td>
            <td>Benjamin Green</td>
            <td>Testing</td>
            <td>72000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>45</td>
            <td>Mason King</td>
            <td>Testing</td>
            <td>67000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>29</td>
            <td>Zoe Wright</td>
            <td>Testing</td>
            <td>71000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>24</td>
            <td>Benjamin Lewis</td>
            <td>Testing</td>
            <td>69000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>34</td>
            <td>Ruby Harris</td>
            <td>Testing</td>
            <td>71000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>20</td>
            <td>Jacob Scott</td>
            <td>Testing</td>
            <td>71000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>15</td>
            <td>Isabella Martinez</td>
            <td>Testing</td>
            <td>64000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>12</td>
            <td>Lucas Thomas</td>
            <td>Testing</td>
            <td>63000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>110</td>
            <td>Liam Davis</td>
            <td>Testing</td>
            <td>48000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>114</td>
            <td>Benjamin Carter</td>
            <td>Testing</td>
            <td>41000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Olivia Wilson</td>
            <td>Testing</td>
            <td>66000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>118</td>
            <td>Jackson Harris</td>
            <td>Testing</td>
            <td>50000</td>
            <td>6081000</td>
        </tr>
        <tr>
            <td>119</td>
            <td>Zoey Miller</td>
            <td>None</td>
            <td>59000</td>
            <td>6635000</td>
        </tr>
        <tr>
            <td>106</td>
            <td>Sophia Wilson</td>
            <td>None</td>
            <td>52000</td>
            <td>6635000</td>
        </tr>
        <tr>
            <td>55</td>
            <td>Liam Johnson</td>
            <td>None</td>
            <td>60000</td>
            <td>6635000</td>
        </tr>
        <tr>
            <td>42</td>
            <td>Lucas Rodriguez</td>
            <td>None</td>
            <td>80000</td>
            <td>6635000</td>
        </tr>
        <tr>
            <td>41</td>
            <td>Megan Mitchell</td>
            <td>None</td>
            <td>55000</td>
            <td>6635000</td>
        </tr>
        <tr>
            <td>21</td>
            <td>Ella Adams</td>
            <td>None</td>
            <td>54000</td>
            <td>6635000</td>
        </tr>
        <tr>
            <td>9</td>
            <td>James Martinez</td>
            <td>None</td>
            <td>59000</td>
            <td>6635000</td>
        </tr>
        <tr>
            <td>46</td>
            <td>Jack Taylor</td>
            <td>None</td>
            <td>60000</td>
            <td>6635000</td>
        </tr>
        <tr>
            <td>61</td>
            <td>William Harris</td>
            <td>None</td>
            <td>75000</td>
            <td>6635000</td>
        </tr>
    </tbody>
</table>



# Scalar Subqueries
- Writing a query inside another query
- Return single row single column as result
- Find out all the employees from your table who are earning more than
- the average salary of all the employees
- Find out the second highest salary (distinct) from your table


```sql
%%sql
SELECT AVG(salary) FROM employee
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>AVG(SALARY)</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>58716.8141592920353982300884955752212389</td>
        </tr>
    </tbody>
</table>




```sql
%%sql
SELECT id, name, department, salary FROM employee WHERE salary >
(SELECT AVG(salary) FROM employee)
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>id</th>
            <th>name</th>
            <th>department</th>
            <th>salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>23</td>
            <td>Lily Carter</td>
            <td>Operations</td>
            <td>75000</td>
        </tr>
        <tr>
            <td>26</td>
            <td>Matthew Hall</td>
            <td>SW</td>
            <td>72000</td>
        </tr>
        <tr>
            <td>30</td>
            <td>Alexander Green</td>
            <td>SW</td>
            <td>83000</td>
        </tr>
        <tr>
            <td>34</td>
            <td>Ruby Harris</td>
            <td>Testing</td>
            <td>71000</td>
        </tr>
        <tr>
            <td>43</td>
            <td>Sophia Hernandez</td>
            <td>HR</td>
            <td>75000</td>
        </tr>
        <tr>
            <td>46</td>
            <td>Jack Taylor</td>
            <td>None</td>
            <td>60000</td>
        </tr>
        <tr>
            <td>49</td>
            <td>Mia Robinson</td>
            <td>HR</td>
            <td>71000</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Jane Smith</td>
            <td>SW</td>
            <td>62000</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Sam Williams</td>
            <td>Operations</td>
            <td>73000</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Emily Brown</td>
            <td>Testing</td>
            <td>67000</td>
        </tr>
        <tr>
            <td>5</td>
            <td>David Johnson</td>
            <td>HR</td>
            <td>75000</td>
        </tr>
        <tr>
            <td>7</td>
            <td>Michael Davis</td>
            <td>Operations</td>
            <td>82000</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Olivia Wilson</td>
            <td>Testing</td>
            <td>66000</td>
        </tr>
        <tr>
            <td>9</td>
            <td>James Martinez</td>
            <td>None</td>
            <td>59000</td>
        </tr>
        <tr>
            <td>10</td>
            <td>Sophia Taylor</td>
            <td>SW</td>
            <td>70000</td>
        </tr>
        <tr>
            <td>12</td>
            <td>Lucas Thomas</td>
            <td>Testing</td>
            <td>63000</td>
        </tr>
        <tr>
            <td>15</td>
            <td>Isabella Martinez</td>
            <td>Testing</td>
            <td>64000</td>
        </tr>
        <tr>
            <td>18</td>
            <td>Henry Clark</td>
            <td>HR</td>
            <td>80000</td>
        </tr>
        <tr>
            <td>19</td>
            <td>Mia Young</td>
            <td>SW</td>
            <td>60000</td>
        </tr>
        <tr>
            <td>20</td>
            <td>Jacob Scott</td>
            <td>Testing</td>
            <td>71000</td>
        </tr>
        <tr>
            <td>24</td>
            <td>Benjamin Lewis</td>
            <td>Testing</td>
            <td>69000</td>
        </tr>
        <tr>
            <td>25</td>
            <td>Chloe Walker</td>
            <td>HR</td>
            <td>64000</td>
        </tr>
        <tr>
            <td>27</td>
            <td>Charlotte King</td>
            <td>Operations</td>
            <td>78000</td>
        </tr>
        <tr>
            <td>29</td>
            <td>Zoe Wright</td>
            <td>Testing</td>
            <td>71000</td>
        </tr>
        <tr>
            <td>32</td>
            <td>Oliver Martin</td>
            <td>SW</td>
            <td>66000</td>
        </tr>
        <tr>
            <td>35</td>
            <td>Jack Carter</td>
            <td>SW</td>
            <td>75000</td>
        </tr>
        <tr>
            <td>36</td>
            <td>Liam Allen</td>
            <td>Operations</td>
            <td>73000</td>
        </tr>
        <tr>
            <td>38</td>
            <td>Charlie Scott</td>
            <td>SW</td>
            <td>68000</td>
        </tr>
        <tr>
            <td>40</td>
            <td>Daniel Young</td>
            <td>Operations</td>
            <td>70000</td>
        </tr>
        <tr>
            <td>42</td>
            <td>Lucas Rodriguez</td>
            <td>None</td>
            <td>80000</td>
        </tr>
        <tr>
            <td>44</td>
            <td>Evan Moore</td>
            <td>Operations</td>
            <td>85000</td>
        </tr>
        <tr>
            <td>45</td>
            <td>Mason King</td>
            <td>Testing</td>
            <td>67000</td>
        </tr>
        <tr>
            <td>47</td>
            <td>Grace Brown</td>
            <td>SW</td>
            <td>69000</td>
        </tr>
        <tr>
            <td>48</td>
            <td>Benjamin Green</td>
            <td>Testing</td>
            <td>72000</td>
        </tr>
        <tr>
            <td>55</td>
            <td>Liam Johnson</td>
            <td>None</td>
            <td>60000</td>
        </tr>
        <tr>
            <td>61</td>
            <td>William Harris</td>
            <td>None</td>
            <td>75000</td>
        </tr>
        <tr>
            <td>63</td>
            <td>Henry Green</td>
            <td>SW</td>
            <td>70000</td>
        </tr>
        <tr>
            <td>65</td>
            <td>Noah Carter</td>
            <td>Testing</td>
            <td>60000</td>
        </tr>
        <tr>
            <td>67</td>
            <td>Zoe Evans</td>
            <td>SW</td>
            <td>65000</td>
        </tr>
        <tr>
            <td>71</td>
            <td>Ava Robinson</td>
            <td>SW</td>
            <td>62000</td>
        </tr>
        <tr>
            <td>72</td>
            <td>Benjamin Walker</td>
            <td>Operations</td>
            <td>68000</td>
        </tr>
        <tr>
            <td>75</td>
            <td>Oliver Wilson</td>
            <td>Operations</td>
            <td>63000</td>
        </tr>
        <tr>
            <td>81</td>
            <td>Emily Walker</td>
            <td>Testing</td>
            <td>60000</td>
        </tr>
        <tr>
            <td>84</td>
            <td>Zoe Walker</td>
            <td>Testing</td>
            <td>62000</td>
        </tr>
        <tr>
            <td>85</td>
            <td>Jack Harris</td>
            <td>SW</td>
            <td>72000</td>
        </tr>
        <tr>
            <td>87</td>
            <td>Ava Wilson</td>
            <td>Testing</td>
            <td>65000</td>
        </tr>
        <tr>
            <td>89</td>
            <td>Emma Turner</td>
            <td>Operations</td>
            <td>69000</td>
        </tr>
        <tr>
            <td>93</td>
            <td>Mason Harris</td>
            <td>Testing</td>
            <td>62000</td>
        </tr>
        <tr>
            <td>98</td>
            <td>Lily Green</td>
            <td>Operations</td>
            <td>65000</td>
        </tr>
        <tr>
            <td>101</td>
            <td>James Johnson</td>
            <td>SW</td>
            <td>70000</td>
        </tr>
        <tr>
            <td>109</td>
            <td>Samuel Rodriguez</td>
            <td>SW</td>
            <td>60000</td>
        </tr>
        <tr>
            <td>113</td>
            <td>Grace Martinez</td>
            <td>HR</td>
            <td>61000</td>
        </tr>
        <tr>
            <td>119</td>
            <td>Zoey Miller</td>
            <td>None</td>
            <td>59000</td>
        </tr>
        <tr>
            <td>120</td>
            <td>Nathan Moore</td>
            <td>SW</td>
            <td>62000</td>
        </tr>
    </tbody>
</table>



### Find out the second highest distinct salary from employee table



```sql
%%sql
SELECT MAX(salary) FROM employee WHERE salary < (SELECT MAX(salary) FROM employee)
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>MAX(SALARY)</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>83000</td>
        </tr>
    </tbody>
</table>




```sql
%%sql
SELECT COUNT(DISTINCT gender) FROM employee
```

     * oracle+oracledb://c%23%23pavan:***@localhost:1521/XE
    0 rows affected.
    




<table>
    <thead>
        <tr>
            <th>COUNT(DISTINCTGENDER)</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>2</td>
        </tr>
    </tbody>
</table>


